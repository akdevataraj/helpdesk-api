{"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\test\\request.spec.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\test\\request.spec.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":30}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":37}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":37}},"5":{"start":{"line":7,"column":16},"end":{"line":7,"column":32}},"6":{"start":{"line":8,"column":17},"end":{"line":8,"column":34}},"7":{"start":{"line":9,"column":16},"end":{"line":9,"column":57}},"8":{"start":{"line":10,"column":18},"end":{"line":10,"column":46}},"9":{"start":{"line":12,"column":13},"end":{"line":12,"column":28}},"10":{"start":{"line":13,"column":14},"end":{"line":13,"column":30}},"11":{"start":{"line":14,"column":23},"end":{"line":14,"column":71}},"12":{"start":{"line":15,"column":23},"end":{"line":15,"column":50}},"13":{"start":{"line":16,"column":15},"end":{"line":16,"column":26}},"14":{"start":{"line":17,"column":16},"end":{"line":17,"column":18}},"15":{"start":{"line":18,"column":17},"end":{"line":18,"column":19}},"16":{"start":{"line":19,"column":0},"end":{"line":19,"column":25}},"17":{"start":{"line":20,"column":14},"end":{"line":20,"column":111}},"18":{"start":{"line":21,"column":0},"end":{"line":59,"column":3}},"19":{"start":{"line":23,"column":4},"end":{"line":31,"column":8}},"20":{"start":{"line":23,"column":25},"end":{"line":31,"column":6}},"21":{"start":{"line":24,"column":8},"end":{"line":24,"column":39}},"22":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"23":{"start":{"line":26,"column":21},"end":{"line":26,"column":63}},"24":{"start":{"line":27,"column":8},"end":{"line":27,"column":31}},"25":{"start":{"line":28,"column":23},"end":{"line":28,"column":67}},"26":{"start":{"line":29,"column":8},"end":{"line":29,"column":32}},"27":{"start":{"line":30,"column":8},"end":{"line":30,"column":71}},"28":{"start":{"line":32,"column":4},"end":{"line":34,"column":8}},"29":{"start":{"line":32,"column":24},"end":{"line":34,"column":6}},"30":{"start":{"line":33,"column":8},"end":{"line":33,"column":28}},"31":{"start":{"line":35,"column":4},"end":{"line":42,"column":8}},"32":{"start":{"line":35,"column":78},"end":{"line":42,"column":6}},"33":{"start":{"line":36,"column":23},"end":{"line":36,"column":48}},"34":{"start":{"line":37,"column":8},"end":{"line":41,"column":11}},"35":{"start":{"line":39,"column":12},"end":{"line":39,"column":44}},"36":{"start":{"line":40,"column":12},"end":{"line":40,"column":52}},"37":{"start":{"line":43,"column":4},"end":{"line":50,"column":8}},"38":{"start":{"line":43,"column":74},"end":{"line":50,"column":6}},"39":{"start":{"line":44,"column":23},"end":{"line":44,"column":48}},"40":{"start":{"line":45,"column":8},"end":{"line":49,"column":11}},"41":{"start":{"line":47,"column":12},"end":{"line":47,"column":44}},"42":{"start":{"line":48,"column":12},"end":{"line":48,"column":49}},"43":{"start":{"line":51,"column":4},"end":{"line":58,"column":8}},"44":{"start":{"line":51,"column":70},"end":{"line":58,"column":6}},"45":{"start":{"line":52,"column":23},"end":{"line":52,"column":48}},"46":{"start":{"line":53,"column":8},"end":{"line":57,"column":11}},"47":{"start":{"line":55,"column":12},"end":{"line":55,"column":44}},"48":{"start":{"line":56,"column":12},"end":{"line":56,"column":53}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":21,"column":29},"end":{"line":21,"column":30}},"loc":{"start":{"line":21,"column":35},"end":{"line":59,"column":1}},"line":21},"1":{"name":"(anonymous_1)","decl":{"start":{"line":23,"column":19},"end":{"line":23,"column":20}},"loc":{"start":{"line":23,"column":25},"end":{"line":31,"column":6}},"line":23},"2":{"name":"(anonymous_2)","decl":{"start":{"line":23,"column":67},"end":{"line":23,"column":68}},"loc":{"start":{"line":23,"column":80},"end":{"line":31,"column":5}},"line":23},"3":{"name":"(anonymous_3)","decl":{"start":{"line":32,"column":18},"end":{"line":32,"column":19}},"loc":{"start":{"line":32,"column":24},"end":{"line":34,"column":6}},"line":32},"4":{"name":"(anonymous_4)","decl":{"start":{"line":32,"column":66},"end":{"line":32,"column":67}},"loc":{"start":{"line":32,"column":79},"end":{"line":34,"column":5}},"line":32},"5":{"name":"(anonymous_5)","decl":{"start":{"line":35,"column":72},"end":{"line":35,"column":73}},"loc":{"start":{"line":35,"column":78},"end":{"line":42,"column":6}},"line":35},"6":{"name":"(anonymous_6)","decl":{"start":{"line":35,"column":120},"end":{"line":35,"column":121}},"loc":{"start":{"line":35,"column":133},"end":{"line":42,"column":5}},"line":35},"7":{"name":"(anonymous_7)","decl":{"start":{"line":38,"column":18},"end":{"line":38,"column":19}},"loc":{"start":{"line":38,"column":30},"end":{"line":41,"column":9}},"line":38},"8":{"name":"(anonymous_8)","decl":{"start":{"line":43,"column":68},"end":{"line":43,"column":69}},"loc":{"start":{"line":43,"column":74},"end":{"line":50,"column":6}},"line":43},"9":{"name":"(anonymous_9)","decl":{"start":{"line":43,"column":116},"end":{"line":43,"column":117}},"loc":{"start":{"line":43,"column":129},"end":{"line":50,"column":5}},"line":43},"10":{"name":"(anonymous_10)","decl":{"start":{"line":46,"column":18},"end":{"line":46,"column":19}},"loc":{"start":{"line":46,"column":30},"end":{"line":49,"column":9}},"line":46},"11":{"name":"(anonymous_11)","decl":{"start":{"line":51,"column":64},"end":{"line":51,"column":65}},"loc":{"start":{"line":51,"column":70},"end":{"line":58,"column":6}},"line":51},"12":{"name":"(anonymous_12)","decl":{"start":{"line":51,"column":112},"end":{"line":51,"column":113}},"loc":{"start":{"line":51,"column":125},"end":{"line":58,"column":5}},"line":51},"13":{"name":"(anonymous_13)","decl":{"start":{"line":54,"column":18},"end":{"line":54,"column":19}},"loc":{"start":{"line":54,"column":30},"end":{"line":57,"column":9}},"line":54}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":0,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/test/request.spec.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/test/request.spec.ts"],"names":[],"mappings":"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","sourcesContent":["\r\nprocess.env.NODE_ENV = 'test';\r\nimport { Server } from '../server';\r\nimport { config } from '../config';\r\nimport { describe, it, before, after } from 'mocha';\r\nimport { Container } from 'typedi';\r\nimport axios from 'axios';\r\nimport { RequestModel } from '../models/request';\r\n\r\n//Require the dev-dependencies\r\nconst chai = require('chai');\r\nconst sinon = require('sinon');\r\nimport jwt from 'jsonwebtoken';\r\nconst chaiaspromised = require('chai-as-promised');\r\nconst expect = chai.expect;\r\n\r\nconst request = {};\r\nconst requests = [];\r\nchai.use(chaiaspromised);\r\n\r\nconst token = jwt.sign({ request: request }, config.jwtSecret, { expiresIn: '1h' });\r\n\r\ndescribe('/Request', () => {\r\n\r\n    let server;\r\n    before(async () => {\r\n        server = new Server();\r\n        server.startServer();\r\n        const find = sinon.stub(RequestModel, 'find')\r\n        find.returns(requests);\r\n        const create = sinon.stub(RequestModel, 'create')\r\n        create.returns(request);\r\n        Container.set('requestModel', RequestModel);\r\n    });\r\n\r\n    after(async () => {\r\n        server.stopServer();\r\n    })\r\n\r\n\r\n    it('it should be fulfilled and return list of all request', async () => {\r\n        const header = { 'x-auth-token': token };\r\n        return expect(axios.get('http://localhost:5000/api/request',\r\n            { headers: header })).to.be.fulfilled\r\n            .then(response => {\r\n                expect(response).not.to.be.null\r\n                expect(response.data).to.be.an('array')\r\n            })\r\n    });\r\n\r\n    it('it should be fulfilled and return request details', async () => {\r\n        const header = { 'x-auth-token': token };\r\n        return expect(axios.get('http://localhost:5000/api/request/1',\r\n            { headers: header })).to.be.fulfilled\r\n            .then(response => {\r\n                expect(response).not.to.be.null\r\n                expect(response.data).not.to.be.null\r\n            })\r\n    });\r\n\r\n    it('it should be fulfilled and create new request', async () => {\r\n        const header = { 'x-auth-token': token };\r\n        return expect(axios.post('http://localhost:5000/api/request', {},\r\n            { headers: header })).to.be.fulfilled\r\n            .then(response => {\r\n                expect(response).not.to.be.null\r\n                expect(response.data).to.be.an('Object')\r\n            })\r\n    });\r\n});\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4de07fcb88bc008273459e3d938bfc60ba0c742e","contentHash":"49b007e4dd372aa42f5a243683c571a2186d55a79dcd9310b405ab582011cee7"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\server.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\server.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":24}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":28}},"4":{"start":{"line":6,"column":18},"end":{"line":6,"column":61}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":41}},"6":{"start":{"line":8,"column":17},"end":{"line":8,"column":47}},"7":{"start":{"line":9,"column":18},"end":{"line":9,"column":43}},"8":{"start":{"line":12,"column":8},"end":{"line":12,"column":39}},"9":{"start":{"line":13,"column":8},"end":{"line":24,"column":11}},"10":{"start":{"line":13,"column":33},"end":{"line":24,"column":10}},"11":{"start":{"line":14,"column":12},"end":{"line":14,"column":46}},"12":{"start":{"line":15,"column":12},"end":{"line":15,"column":73}},"13":{"start":{"line":16,"column":12},"end":{"line":19,"column":15}},"14":{"start":{"line":18,"column":16},"end":{"line":18,"column":93}},"15":{"start":{"line":20,"column":12},"end":{"line":23,"column":15}},"16":{"start":{"line":21,"column":16},"end":{"line":21,"column":46}},"17":{"start":{"line":22,"column":16},"end":{"line":22,"column":32}},"18":{"start":{"line":25,"column":8},"end":{"line":27,"column":11}},"19":{"start":{"line":25,"column":32},"end":{"line":27,"column":10}},"20":{"start":{"line":26,"column":12},"end":{"line":26,"column":32}},"21":{"start":{"line":30,"column":0},"end":{"line":30,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":18},"end":{"line":28,"column":5}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":27},"end":{"line":13,"column":28}},"loc":{"start":{"line":13,"column":33},"end":{"line":24,"column":10}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":73},"end":{"line":13,"column":74}},"loc":{"start":{"line":13,"column":86},"end":{"line":24,"column":9}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":46},"end":{"line":17,"column":47}},"loc":{"start":{"line":17,"column":52},"end":{"line":19,"column":13}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":20,"column":36},"end":{"line":20,"column":37}},"loc":{"start":{"line":20,"column":43},"end":{"line":23,"column":13}},"line":20},"5":{"name":"(anonymous_5)","decl":{"start":{"line":25,"column":26},"end":{"line":25,"column":27}},"loc":{"start":{"line":25,"column":32},"end":{"line":27,"column":10}},"line":25},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":72},"end":{"line":25,"column":73}},"loc":{"start":{"line":25,"column":85},"end":{"line":27,"column":9}},"line":25}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":2,"10":2,"11":2,"12":2,"13":2,"14":2,"15":2,"16":0,"17":0,"18":2,"19":2,"20":2,"21":1},"f":{"0":2,"1":2,"2":2,"3":2,"4":0,"5":2,"6":2},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/server.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/server.ts"],"names":[],"mappings":";;;;AAAA,4BAA0B,CAAC,2CAA2C;AACtE,8DAA8B;AAC9B,0CAAuC;AACvC,gDAAgD;AAChD,4CAAyC;AAEzC,MAAa,MAAM;IAAnB;QACE,QAAG,GAAG,iBAAO,EAAE,CAAC;QAET,gBAAW,GAAG,GAAS,EAAE;YAE9B,MAAM,iBAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACxB,kBAAS,CAAC,KAAK,CAAC,YAAY,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;YACpD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG;iBACnB,MAAM,CAAC,eAAM,CAAC,IAAI,EAAE,GAAG,EAAE;gBACxB,kBAAS,CAAC,IAAI,CAAC,6BAA6B,eAAM,CAAC,IAAI,EAAE,CAAC,CAAC;YAC7D,CAAC,CAAC,CAAC;YACL,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,CAAC,EAAE;gBAC1B,kBAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACrB,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAClB,CAAC,CAAC,CAAA;QACN,CAAC,CAAA,CAAC;QAEK,eAAU,GAAG,GAAS,EAAE;YAC7B,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;QACtB,CAAC,CAAA,CAAA;IACH,CAAC;CAAA;AApBD,wBAoBC","sourcesContent":["import 'reflect-metadata'; // We need this in order to use @Decorators\nimport express from 'express';\nimport { config } from '../src/config';\nimport { loggerDev } from '../src/utils/logger';\nimport { loaders } from '../src/loaders';\n\nexport class Server {\n  app = express();\n  server;\n  public startServer = async () => {\n    \n    await loaders(this.app);\n    loggerDev.debug(`MODE ENV ${process.env.NODE_ENV}`);\n    this.server = this.app\n      .listen(config.port, () => {\n        loggerDev.info(`Server listening on port: ${config.port}`);\n      });\n    this.server.on('error', err => {\n        loggerDev.error(err);\n        process.exit(1);\n      })    \n  };\n\n  public stopServer = async () => {\n    this.server.close();\n  }\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f7b76fc7846d7fbce1fd4daf6863aba024db3119","contentHash":"7c769da0aed959b9869bf86cfa985102865f62ad266b1bf5a675f7fa0064ffc7"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\config\\index.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\config\\index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":59}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":61}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":84}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":61}},"7":{"start":{"line":9,"column":17},"end":{"line":9,"column":42}},"8":{"start":{"line":10,"column":0},"end":{"line":12,"column":1}},"9":{"start":{"line":11,"column":4},"end":{"line":11,"column":47}},"10":{"start":{"line":13,"column":0},"end":{"line":29,"column":2}},"11":{"start":{"line":31,"column":0},"end":{"line":36,"column":50}},"12":{"start":{"line":32,"column":4},"end":{"line":32,"column":27}},"13":{"start":{"line":33,"column":4},"end":{"line":33,"column":29}},"14":{"start":{"line":34,"column":4},"end":{"line":34,"column":33}},"15":{"start":{"line":35,"column":4},"end":{"line":35,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":31,"column":1},"end":{"line":31,"column":2}},"loc":{"start":{"line":31,"column":18},"end":{"line":36,"column":1}},"line":31}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":23},"end":{"line":6,"column":60}},"type":"binary-expr","locations":[{"start":{"line":6,"column":23},"end":{"line":6,"column":43}},{"start":{"line":6,"column":47},"end":{"line":6,"column":60}}],"line":6},"1":{"loc":{"start":{"line":7,"column":26},"end":{"line":7,"column":83}},"type":"binary-expr","locations":[{"start":{"line":7,"column":26},"end":{"line":7,"column":49}},{"start":{"line":7,"column":53},"end":{"line":7,"column":83}}],"line":7},"2":{"loc":{"start":{"line":8,"column":25},"end":{"line":8,"column":60}},"type":"binary-expr","locations":[{"start":{"line":8,"column":25},"end":{"line":8,"column":47}},{"start":{"line":8,"column":51},"end":{"line":8,"column":60}}],"line":8},"3":{"loc":{"start":{"line":10,"column":0},"end":{"line":12,"column":1}},"type":"if","locations":[{"start":{"line":10,"column":0},"end":{"line":12,"column":1}},{"start":{"line":10,"column":0},"end":{"line":12,"column":1}}],"line":10},"4":{"loc":{"start":{"line":14,"column":10},"end":{"line":14,"column":34}},"type":"binary-expr","locations":[{"start":{"line":14,"column":10},"end":{"line":14,"column":26}},{"start":{"line":14,"column":30},"end":{"line":14,"column":34}}],"line":14},"5":{"loc":{"start":{"line":19,"column":15},"end":{"line":19,"column":47}},"type":"binary-expr","locations":[{"start":{"line":19,"column":15},"end":{"line":19,"column":36}},{"start":{"line":19,"column":40},"end":{"line":19,"column":47}}],"line":19},"6":{"loc":{"start":{"line":36,"column":11},"end":{"line":36,"column":48}},"type":"binary-expr","locations":[{"start":{"line":36,"column":11},"end":{"line":36,"column":24}},{"start":{"line":36,"column":29},"end":{"line":36,"column":47}}],"line":36}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1},"f":{"0":1},"b":{"0":[1,0],"1":[1,1],"2":[1,1],"3":[0,1],"4":[1,1],"5":[1,1],"6":[1,1]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/config/index.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/config/index.ts"],"names":[],"mappings":";;;;AAAA,4DAA4B;AAE5B,OAAO,CAAC,GAAG,CAAC,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI,aAAa,CAAC;AAC7D,OAAO,CAAC,GAAG,CAAC,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,8BAA8B,CAAC;AACpF,OAAO,CAAC,GAAG,CAAC,UAAU,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,SAAS,CAAC;AAC7D,MAAM,QAAQ,GAAG,gBAAM,CAAC,MAAM,EAAE,CAAC;AACjC,IAAI,QAAQ,CAAC,KAAK,EAAE;IAClB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;CAC5C;AAEY,QAAA,MAAM,GAAG;IACpB,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI;IAC9B,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW;IAC9B,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU;IACjC,IAAI,EAAE;QACJ,yBAAyB;QACzB,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI,OAAO;KACxC;IACD,GAAG,EAAE;QACH,MAAM,EAAE,MAAM;KACf;IACD,MAAM,EAAE;QACN,6BAA6B;QAC7B,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,gBAAgB;QACpC,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,eAAe;KACpC;CACF,CAAC;AAEF,IAAY,KAKX;AALD,WAAY,KAAK;IACf,sBAAa,CAAA;IACb,wBAAe,CAAA;IACf,4BAAmB,CAAA;IACnB,4BAAmB,CAAA;AACrB,CAAC,EALW,KAAK,GAAL,aAAK,KAAL,aAAK,QAKhB","sourcesContent":["import dotenv from 'dotenv';\n\nprocess.env.NODE_ENV = process.env.NODE_ENV || 'development';\nprocess.env.MONGODB_URI = process.env.MONGODB_URI || 'mongodb://0.0.0.0:27017/MyDb';\nprocess.env.JWT_SECRET = process.env.JWT_SECRET || '1234567';\nconst envFound = dotenv.config();\nif (envFound.error) {\n  throw new Error(\"Couldn't find .env file\");\n}\n\nexport const config = {\n  port: process.env.PORT || 5000,\n  dbUrl: process.env.MONGODB_URI,\n  jwtSecret: process.env.JWT_SECRET,\n  logs: {\n    // Used by winston logger\n    level: process.env.LOG_LEVEL || 'silly',\n  },\n  api: {\n    prefix: '/api',\n  },\n  emails: {\n    // SENDGRID email credentials\n    apiKey: process.env.SENDGRID_API_KEY,\n    sender: process.env.SENDGRID_SENDER,\n  },\n};\n\nexport enum MODES {\n  TEST = 'test',\n  LOCAL = 'local',\n  DEV = 'development',\n  PROD = 'production',\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"23c17a417dbb5dc2bdcf65ccb44f6cf58b353f88","contentHash":"49bbd89dca5382dc84f931ec72c0e3063ce19c753dd31324f9fa134876578407"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\utils\\logger.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\utils\\logger.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":44}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":61}},"4":{"start":{"line":9,"column":21},"end":{"line":16,"column":2}},"5":{"start":{"line":10,"column":42},"end":{"line":10,"column":46}},"6":{"start":{"line":11,"column":17},"end":{"line":11,"column":42}},"7":{"start":{"line":12,"column":20},"end":{"line":14,"column":12}},"8":{"start":{"line":13,"column":26},"end":{"line":13,"column":95}},"9":{"start":{"line":15,"column":4},"end":{"line":15,"column":70}},"10":{"start":{"line":17,"column":15},"end":{"line":24,"column":2}},"11":{"start":{"line":25,"column":0},"end":{"line":25,"column":24}},"12":{"start":{"line":26,"column":0},"end":{"line":28,"column":1}},"13":{"start":{"line":27,"column":4},"end":{"line":27,"column":59}},"14":{"start":{"line":32,"column":19},"end":{"line":32,"column":21}},"15":{"start":{"line":33,"column":0},"end":{"line":40,"column":1}},"16":{"start":{"line":34,"column":4},"end":{"line":34,"column":64}},"17":{"start":{"line":37,"column":4},"end":{"line":39,"column":8}},"18":{"start":{"line":41,"column":18},"end":{"line":48,"column":2}},"19":{"start":{"line":49,"column":0},"end":{"line":49,"column":30}},"20":{"start":{"line":50,"column":0},"end":{"line":50,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":53},"end":{"line":9,"column":54}},"loc":{"start":{"line":9,"column":61},"end":{"line":16,"column":1}},"line":9},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":19},"end":{"line":13,"column":20}},"loc":{"start":{"line":13,"column":26},"end":{"line":13,"column":95}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":20},"end":{"line":14,"column":12}},"type":"cond-expr","locations":[{"start":{"line":13,"column":10},"end":{"line":13,"column":96}},{"start":{"line":14,"column":10},"end":{"line":14,"column":12}}],"line":12},"1":{"loc":{"start":{"line":13,"column":26},"end":{"line":13,"column":95}},"type":"cond-expr","locations":[{"start":{"line":13,"column":50},"end":{"line":13,"column":78}},{"start":{"line":13,"column":81},"end":{"line":13,"column":95}}],"line":13},"2":{"loc":{"start":{"line":26,"column":0},"end":{"line":28,"column":1}},"type":"if","locations":[{"start":{"line":26,"column":0},"end":{"line":28,"column":1}},{"start":{"line":26,"column":0},"end":{"line":28,"column":1}}],"line":26},"3":{"loc":{"start":{"line":33,"column":0},"end":{"line":40,"column":1}},"type":"if","locations":[{"start":{"line":33,"column":0},"end":{"line":40,"column":1}},{"start":{"line":33,"column":0},"end":{"line":40,"column":1}}],"line":33}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":7,"6":7,"7":7,"8":0,"9":7,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":0,"18":1,"19":1,"20":1},"f":{"0":7,"1":0},"b":{"0":[0,7],"1":[0,0],"2":[1,0],"3":[1,0]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/utils/logger.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/utils/logger.ts"],"names":[],"mappings":";;;;AAAA,8DAA8B;AAE9B,qDAAqD;AACrD,qDAAqD;AACrD,qDAAqD;AACrD,MAAM,YAAY,GAAG,iBAAO,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;IAChD,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC;IAC3C,MAAM,IAAI,GACR,IAAI,CAAE,MAAM,CAAC,GAAG,CAAC,OAAO,CAAuB,CAAC,CAAC;IACnD,MAAM,OAAO,GAAG,IAAI;QAClB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CACb,GAAG,YAAY,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,EAAE,CACtE;QACH,CAAC,CAAC,EAAE,CAAC;IACP,OAAO,GAAG,SAAS,MAAM,KAAK,KAAK,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;AACpE,CAAC,CAAC,CAAC;AAEH,MAAM,MAAM,GAAG,iBAAO,CAAC,YAAY,CAAC;IAClC,KAAK,EAAE,OAAO;IACd,MAAM,EAAE,iBAAO,CAAC,MAAM,CAAC,OAAO,CAC5B,iBAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,EACzB,iBAAO,CAAC,MAAM,CAAC,SAAS,EAAE,EAC1B,YAAY,CACb;IACD,UAAU,EAAE;QACV,IAAI,iBAAO,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,gBAAgB,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;QAC3E,IAAI,iBAAO,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,cAAc,EAAE,CAAC;KAC1D;CACF,CAAC,CAAC;AAqCM,wBAAM;AAnCf,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;IACzC,MAAM,CAAC,GAAG,CAAC,IAAI,iBAAO,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC;CAC9C;AAED,qDAAqD;AACrD,qDAAqD;AACrD,qDAAqD;AACrD,MAAM,UAAU,GAAG,EAAE,CAAC;AACtB,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,aAAa,EAAE;IAC1C,UAAU,CAAC,IAAI,CAAC,IAAI,iBAAO,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC;CACnD;KAAM;IACL,UAAU,CAAC,IAAI,CACb,IAAI,iBAAO,CAAC,UAAU,CAAC,OAAO,CAAC;QAC7B,MAAM,EAAE,iBAAO,CAAC,MAAM,CAAC,OAAO,CAC5B,iBAAO,CAAC,MAAM,CAAC,GAAG,EAAE,EACpB,iBAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CACvB;KACF,CAAC,CACH,CAAC;CACH;AAED,MAAM,SAAS,GAAG,iBAAO,CAAC,YAAY,CAAC;IACrC,KAAK,EAAE,OAAO;IACd,MAAM,EAAE,iBAAO,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM;IACjC,MAAM,EAAE,iBAAO,CAAC,MAAM,CAAC,OAAO,CAC5B,iBAAO,CAAC,MAAM,CAAC,SAAS,CAAC;QACvB,MAAM,EAAE,qBAAqB;KAC9B,CAAC,EACF,iBAAO,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,EACtC,iBAAO,CAAC,MAAM,CAAC,KAAK,EAAE,EACtB,iBAAO,CAAC,MAAM,CAAC,IAAI,EAAE,CACtB;IACD,UAAU;CACX,CAAC,CAAC;AAEc,8BAAS;AAC1B,kBAAe,MAAM,CAAC","sourcesContent":["import winston from 'winston';\n\n//-------------------------------------------------//\n//              LOGGER PROD                        //\n//-------------------------------------------------//\nconst customFormat = winston.format.printf(args => {\n  const { timestamp, level, message } = args;\n  const more: Array<any> | undefined =\n    args[(Symbol.for('splat') as unknown) as string];\n  const moreMsg = more\n    ? more.map(msg =>\n        msg instanceof Object ? JSON.stringify(msg, null, 2) : msg.toString(),\n      )\n    : [];\n  return `${timestamp} | ${level}: ${message} ${moreMsg.join(' ')}`;\n});\n\nconst logger = winston.createLogger({\n  level: 'debug',\n  format: winston.format.combine(\n    winston.format.colorize(),\n    winston.format.timestamp(),\n    customFormat,\n  ),\n  transports: [\n    new winston.transports.File({ filename: 'logs/error.log', level: 'error' }),\n    new winston.transports.File({ filename: 'logs/all.log' }),\n  ],\n});\n\nif (process.env.NODE_ENV !== 'production') {\n  logger.add(new winston.transports.Console());\n}\n\n//-------------------------------------------------//\n//              LOGGER DEV                         //\n//-------------------------------------------------//\nconst transports = [];\nif (process.env.NODE_ENV !== 'development') {\n  transports.push(new winston.transports.Console());\n} else {\n  transports.push(\n    new winston.transports.Console({\n      format: winston.format.combine(\n        winston.format.cli(),\n        winston.format.splat(),\n      ),\n    }),\n  );\n}\n\nconst loggerDev = winston.createLogger({\n  level: 'debug',\n  levels: winston.config.npm.levels,\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format: 'YYYY-MM-DD HH:mm:ss',\n    }),\n    winston.format.errors({ stack: true }),\n    winston.format.splat(),\n    winston.format.json(),\n  ),\n  transports,\n});\n\nexport { logger, loggerDev };\nexport default logger;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"857d103b02d6b40858915671aeb9bc26c9a4a0ef","contentHash":"82b5fded3202cc99651b2d42dac2f6a04a532690f19a2fc3bdd2719b6ce2a89a"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\index.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":43}},"4":{"start":{"line":6,"column":18},"end":{"line":6,"column":47}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":49}},"6":{"start":{"line":8,"column":16},"end":{"line":8,"column":42}},"7":{"start":{"line":9,"column":18},"end":{"line":9,"column":46}},"8":{"start":{"line":10,"column":29},"end":{"line":10,"column":60}},"9":{"start":{"line":11,"column":17},"end":{"line":11,"column":34}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":20}},"11":{"start":{"line":13,"column":16},"end":{"line":34,"column":2}},"12":{"start":{"line":13,"column":25},"end":{"line":34,"column":2}},"13":{"start":{"line":14,"column":4},"end":{"line":14,"column":47}},"14":{"start":{"line":15,"column":22},"end":{"line":15,"column":55}},"15":{"start":{"line":16,"column":4},"end":{"line":16,"column":51}},"16":{"start":{"line":17,"column":22},"end":{"line":20,"column":5}},"17":{"start":{"line":21,"column":25},"end":{"line":24,"column":5}},"18":{"start":{"line":25,"column":4},"end":{"line":30,"column":7}},"19":{"start":{"line":31,"column":4},"end":{"line":31,"column":58}},"20":{"start":{"line":32,"column":4},"end":{"line":32,"column":43}},"21":{"start":{"line":33,"column":4},"end":{"line":33,"column":39}},"22":{"start":{"line":35,"column":0},"end":{"line":35,"column":26}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":13,"column":16},"end":{"line":13,"column":17}},"loc":{"start":{"line":13,"column":25},"end":{"line":34,"column":2}},"line":13},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":67},"end":{"line":13,"column":68}},"loc":{"start":{"line":13,"column":80},"end":{"line":34,"column":1}},"line":13}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":2,"13":2,"14":2,"15":2,"16":2,"17":2,"18":2,"19":2,"20":2,"21":2,"22":1},"f":{"0":2,"1":2},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/loaders/index.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/loaders/index.ts"],"names":[],"mappings":";;;;AAAA,4CAA4C;AAC5C,gDAAmD;AAEnD,kDAAqD;AACrD,2CAA4C;AAC5C,+CAAiD;AAEjD,6DAA0D;AAC1D,mCAAmC;AACnC,oBAAkB;AAEX,MAAM,OAAO,GAAG,CAAO,GAAgB,EAAiB,EAAE;IAC/D,kBAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;IAClC,MAAM,SAAS,GAAG,MAAM,yBAAc,EAAE,CAAC;IACzC,kBAAS,CAAC,GAAG,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;IACtC,MAAM,SAAS,GAAa;QAC1B,IAAI,EAAE,WAAW;QACjB,KAAK,EAAE,iBAAS;KACjB,CAAC;IAEF,MAAM,YAAY,GAAa;QAC7B,IAAI,EAAE,cAAc;QACpB,KAAK,EAAE,sBAAY;KACpB,CAAC;IAEF,MAAM,uCAAkB,CAAC;QACvB,MAAM,EAAE;YACN,SAAS;YACT,YAAY;SACb;KACF,CAAC,CAAC;IACH,kBAAS,CAAC,IAAI,CAAC,4BAA4B,CAAC,CAAC;IAC7C,kBAAS,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAE9B,MAAM,uBAAa,CAAC,GAAG,CAAC,CAAC;AAC3B,CAAC,CAAA,CAAC;AAxBW,QAAA,OAAO,WAwBlB","sourcesContent":["import { loggerDev } from '../utils/logger';\nimport { expressLoader } from '../loaders/express';\nimport { Application } from 'express';\nimport { mongooseLoader } from '../loaders/mongoose';\nimport { UserModel } from '../models/users';\nimport { RequestModel } from '../models/request';\nimport { IModelDI } from '../types/dependencyInjectors';\nimport { dependencyInjector } from './dependencyInjector';\nimport { Container } from 'typedi';\nimport './events';\n\nexport const loaders = async (app: Application): Promise<void> => {\n  loggerDev.info('Loaders running');\n  const dbService = await mongooseLoader();\n  Container.set('dbService', dbService);\n  const userModel: IModelDI = {\n    name: 'userModel',\n    model: UserModel,\n  };\n\n  const requestModel: IModelDI = {\n    name: 'requestModel',\n    model: RequestModel,\n  };\n\n  await dependencyInjector({\n    models: [\n      userModel, // whateverModel,\n      requestModel\n    ],\n  });\n  loggerDev.info('Dependency Injector loaded');\n  loggerDev.info('Jobs loaded');\n\n  await expressLoader(app);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1ca7975d6bfae15f593c0f506e1758de826fb1a8","contentHash":"39ffc12ed5c034607540fa3f2d2f26bc93bfd006330f459603456db8b883c066"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\express.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\express.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":61}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":55}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},"6":{"start":{"line":8,"column":17},"end":{"line":8,"column":37}},"7":{"start":{"line":9,"column":17},"end":{"line":9,"column":59}},"8":{"start":{"line":10,"column":21},"end":{"line":10,"column":45}},"9":{"start":{"line":11,"column":22},"end":{"line":39,"column":2}},"10":{"start":{"line":11,"column":31},"end":{"line":39,"column":2}},"11":{"start":{"line":16,"column":4},"end":{"line":18,"column":7}},"12":{"start":{"line":17,"column":8},"end":{"line":17,"column":30}},"13":{"start":{"line":19,"column":4},"end":{"line":21,"column":7}},"14":{"start":{"line":20,"column":8},"end":{"line":20,"column":30}},"15":{"start":{"line":22,"column":4},"end":{"line":24,"column":7}},"16":{"start":{"line":23,"column":8},"end":{"line":23,"column":30}},"17":{"start":{"line":26,"column":4},"end":{"line":26,"column":51}},"18":{"start":{"line":27,"column":4},"end":{"line":27,"column":46}},"19":{"start":{"line":28,"column":4},"end":{"line":28,"column":38}},"20":{"start":{"line":29,"column":4},"end":{"line":29,"column":63}},"21":{"start":{"line":30,"column":4},"end":{"line":30,"column":32}},"22":{"start":{"line":32,"column":4},"end":{"line":32,"column":33}},"23":{"start":{"line":34,"column":4},"end":{"line":34,"column":60}},"24":{"start":{"line":36,"column":4},"end":{"line":36,"column":46}},"25":{"start":{"line":38,"column":4},"end":{"line":38,"column":50}},"26":{"start":{"line":40,"column":0},"end":{"line":40,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":31},"end":{"line":39,"column":2}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":73},"end":{"line":11,"column":74}},"loc":{"start":{"line":11,"column":86},"end":{"line":39,"column":1}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":17},"end":{"line":16,"column":18}},"loc":{"start":{"line":16,"column":31},"end":{"line":18,"column":5}},"line":16},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":23},"end":{"line":19,"column":24}},"loc":{"start":{"line":19,"column":37},"end":{"line":21,"column":5}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":22,"column":24},"end":{"line":22,"column":25}},"loc":{"start":{"line":22,"column":38},"end":{"line":24,"column":5}},"line":22}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":2,"11":2,"12":0,"13":2,"14":0,"15":2,"16":0,"17":2,"18":2,"19":2,"20":2,"21":2,"22":2,"23":2,"24":2,"25":2,"26":1},"f":{"0":2,"1":2,"2":0,"3":0,"4":0},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/loaders/express.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/loaders/express.ts"],"names":[],"mappings":";;;;AAAA,8DAA+C;AAC/C,wDAAwB;AACxB,sCAAsC;AACtC,sCAAmC;AACnC,4DAA4B;AAC5B,8CAA2C;AAEpC,MAAM,aAAa,GAAG,CAAO,GAAgB,EAAE,EAAE;IACtD;;;OAGG;IACH,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QACxB,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACxB,CAAC,CAAC,CAAC;IACH,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QAC9B,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC;IACxB,CAAC,CAAC,CAAC;IACH,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QAC/B,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC;IACxB,CAAC,CAAC,CAAC;IAEH,eAAe;IACf,GAAG,CAAC,GAAG,CAAC,uBAAU,CAAC,aAAa,CAAC,CAAC;IAClC,GAAG,CAAC,GAAG,CAAC,cAAI,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;IAChC,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,IAAI,EAAE,CAAC,CAAC;IACxB,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;IACjD,GAAG,CAAC,GAAG,CAAC,gBAAM,EAAE,CAAC,CAAC;IAElB,kBAAkB;IAClB,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;IAE7B,cAAc;IACd,GAAG,CAAC,GAAG,CAAC,eAAM,CAAC,GAAG,CAAC,MAAM,EAAE,kBAAS,CAAC,CAAC;IAEtC,sBAAsB;IACtB,GAAG,CAAC,GAAG,CAAC,uBAAU,CAAC,QAAQ,CAAC,CAAC;IAE7B,wBAAwB;IACxB,GAAG,CAAC,GAAG,CAAC,uBAAU,CAAC,YAAY,CAAC,CAAC;AACnC,CAAC,CAAA,CAAC;AAjCW,QAAA,aAAa,iBAiCxB","sourcesContent":["import express, { Application } from 'express';\nimport cors from 'cors';\nimport { appRouter } from '../routes';\nimport { config } from '../config';\nimport helmet from 'helmet';\nimport { middleware } from '../middleware';\n\nexport const expressLoader = async (app: Application) => {\n  /**\n   * Health Check endpoints\n   * @TODO Explain why they are here\n   */\n  app.get('/', (req, res) => {\n    res.send('Hi there!');\n  });\n  app.get('/status', (req, res) => {\n    res.status(200).end();\n  });\n  app.head('/status', (req, res) => {\n    res.status(200).end();\n  });\n\n  /* Middleware*/\n  app.use(middleware.requestLogger);\n  app.use(cors({ origin: true }));\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: false }));\n  app.use(helmet());\n\n  /*  Proxy rules */\n  app.set('trust proxy', true);\n\n  /*  Routes  */\n  app.use(config.api.prefix, appRouter);\n\n  /*  404 middleware  */\n  app.use(middleware.notFound);\n\n  /*  Error middleware  */\n  app.use(middleware.errorRequest);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"56f06f0cf9a1d4b4431d8e982131b4a9dd23a862","contentHash":"d831ee3d53bbd42aa139332ec6ad3e68edc688a18efadf26e9ab1bfd2c8cf15c"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\routes\\index.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\routes\\index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":4,"column":18},"end":{"line":4,"column":36}},"3":{"start":{"line":5,"column":15},"end":{"line":5,"column":36}},"4":{"start":{"line":6,"column":18},"end":{"line":6,"column":42}},"5":{"start":{"line":7,"column":18},"end":{"line":7,"column":36}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":30}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":42}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":51}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":28}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/routes/index.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/routes/index.ts"],"names":[],"mappings":";;;AAAA,qCAAiC;AACjC,qCAAwC;AACxC,2CAA8C;AAC9C,MAAM,SAAS,GAAG,gBAAM,EAAE,CAAC;AAKlB,8BAAS;AAHlB,SAAS,CAAC,GAAG,CAAC,OAAO,EAAE,iBAAU,CAAC,CAAC;AACnC,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,uBAAa,CAAC,CAAC;AAGzC,kBAAe,SAAS,CAAC","sourcesContent":["import { Router } from 'express';\nimport { userRouter } from './api/user';\nimport { requestRouter } from './api/request';\nconst appRouter = Router();\n\nappRouter.use('/user', userRouter);\nappRouter.use('/request', requestRouter);\n\nexport { appRouter };\nexport default appRouter;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e73f7279c66b565e541a15a8e22b7a5125ff841","contentHash":"db90f306abd392f8cbe63ebfd64728fd6c80aee9facd75fbc19bc86201cf7a8e"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\routes\\api\\user.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\routes\\api\\user.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":36}},"4":{"start":{"line":6,"column":22},"end":{"line":6,"column":59}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":34}},"6":{"start":{"line":8,"column":32},"end":{"line":8,"column":89}},"7":{"start":{"line":9,"column":21},"end":{"line":9,"column":48}},"8":{"start":{"line":11,"column":19},"end":{"line":11,"column":37}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"10":{"start":{"line":16,"column":0},"end":{"line":23,"column":5}},"11":{"start":{"line":18,"column":46},"end":{"line":23,"column":2}},"12":{"start":{"line":20,"column":24},"end":{"line":20,"column":73}},"13":{"start":{"line":21,"column":17},"end":{"line":21,"column":55}},"14":{"start":{"line":22,"column":4},"end":{"line":22,"column":38}},"15":{"start":{"line":24,"column":0},"end":{"line":26,"column":5}},"16":{"start":{"line":24,"column":102},"end":{"line":26,"column":2}},"17":{"start":{"line":25,"column":4},"end":{"line":25,"column":73}},"18":{"start":{"line":29,"column":0},"end":{"line":40,"column":5}},"19":{"start":{"line":31,"column":46},"end":{"line":40,"column":2}},"20":{"start":{"line":32,"column":4},"end":{"line":39,"column":5}},"21":{"start":{"line":33,"column":28},"end":{"line":33,"column":77}},"22":{"start":{"line":34,"column":22},"end":{"line":34,"column":59}},"23":{"start":{"line":35,"column":8},"end":{"line":35,"column":28}},"24":{"start":{"line":38,"column":8},"end":{"line":38,"column":27}},"25":{"start":{"line":43,"column":0},"end":{"line":49,"column":5}},"26":{"start":{"line":45,"column":46},"end":{"line":49,"column":2}},"27":{"start":{"line":46,"column":24},"end":{"line":46,"column":73}},"28":{"start":{"line":47,"column":18},"end":{"line":47,"column":58}},"29":{"start":{"line":48,"column":4},"end":{"line":48,"column":24}},"30":{"start":{"line":50,"column":0},"end":{"line":50,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":32},"end":{"line":18,"column":33}},"loc":{"start":{"line":18,"column":46},"end":{"line":23,"column":2}},"line":18},"1":{"name":"(anonymous_1)","decl":{"start":{"line":18,"column":88},"end":{"line":18,"column":89}},"loc":{"start":{"line":18,"column":101},"end":{"line":23,"column":1}},"line":18},"2":{"name":"(anonymous_2)","decl":{"start":{"line":24,"column":88},"end":{"line":24,"column":89}},"loc":{"start":{"line":24,"column":102},"end":{"line":26,"column":2}},"line":24},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":144},"end":{"line":24,"column":145}},"loc":{"start":{"line":24,"column":157},"end":{"line":26,"column":1}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":32},"end":{"line":31,"column":33}},"loc":{"start":{"line":31,"column":46},"end":{"line":40,"column":2}},"line":31},"5":{"name":"(anonymous_5)","decl":{"start":{"line":31,"column":88},"end":{"line":31,"column":89}},"loc":{"start":{"line":31,"column":101},"end":{"line":40,"column":1}},"line":31},"6":{"name":"(anonymous_6)","decl":{"start":{"line":45,"column":32},"end":{"line":45,"column":33}},"loc":{"start":{"line":45,"column":46},"end":{"line":49,"column":2}},"line":45},"7":{"name":"(anonymous_7)","decl":{"start":{"line":45,"column":88},"end":{"line":45,"column":89}},"loc":{"start":{"line":45,"column":101},"end":{"line":49,"column":1}},"line":45}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":0,"25":1,"26":1,"27":1,"28":1,"29":0,"30":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/routes/api/user.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/routes/api/user.ts"],"names":[],"mappings":";;;;AAAA,qCAA2C;AAE3C,4DAAyD;AACzD,mCAAmC;AACnC,0FAA4C;AAC5C,iDAA8C;AAC9C,mDAAmD;AAEnD,MAAM,UAAU,GAAG,gBAAM,EAAE,CAAC;AA0DnB,gCAAU;AAzDnB,oCAAoC;AAEpC,eAAe;AACf,+BAA+B;AAE/B,UAAU,CAAC,GAAG,CACZ,GAAG,EACH,uBAAU,CAAC,QAAQ;AACnB,2BAA2B;AAC3B,+BAAO,CAAC,CAAO,GAAQ,EAAE,GAAQ,EAAE,EAAE;IACnC,0CAA0C;IAC1C,MAAM,WAAW,GAAG,kBAAS,CAAC,GAAG,CAAC,yBAAW,CAAC,CAAC;IAC/C,MAAM,IAAI,GAAG,MAAM,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IACpD,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACpC,CAAC,CAAA,CAAC,CACH,CAAC;AAEF,UAAU,CAAC,GAAG,CACZ,KAAK,EACL,uBAAU,CAAC,QAAQ,EACnB,+BAAO,CAAC,CAAO,GAAQ,EAAE,GAAQ,EAAE,EAAE;IACnC,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAG,GAAG,EAAE,cAAc,EAAC,CAAC,CAAC;AACvE,CAAC,CAAA,CAAC,CACH,CAAC;AAEF,gBAAgB;AAChB,kBAAkB;AAClB,UAAU,CAAC,IAAI,CACb,QAAQ;AACR,4BAA4B;AAC5B,+BAAO,CACL,CAAO,GAAgB,EAAE,GAAa,EAAiB,EAAE;IACvD,IAAI;QACF,MAAM,WAAW,GAAG,kBAAS,CAAC,GAAG,CAAC,yBAAW,CAAC,CAAC;QAC/C,MAAM,KAAK,GAAG,MAAM,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACpD,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;KACrB;IAAC,OAAO,KAAK,EAAE;QACd,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KACpB;AACH,CAAC,CAAA,CACF,CACF,CAAC;AAEF,sBAAsB;AACtB,qBAAqB;AACrB,UAAU,CAAC,IAAI,CACb,GAAG;AACH,4BAA4B;AAC5B,+BAAO,CACL,CAAO,GAAgB,EAAE,GAAa,EAAiB,EAAE;IACvD,MAAM,WAAW,GAAG,kBAAS,CAAC,GAAG,CAAC,yBAAW,CAAC,CAAC;IAC/C,MAAM,KAAK,GAAG,MAAM,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACvD,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;AACtB,CAAC,CAAA,CACF,CACF,CAAC;AAGF,kBAAe,UAAU,CAAC","sourcesContent":["import { Router, Response } from 'express';\nimport { RequestUser } from '../../types/user';\nimport { UserService } from '../../services/userService';\nimport { Container } from 'typedi';\nimport handler from 'express-async-handler';\nimport { middleware } from '../../middleware';\n//import { UserSignupDto } from '../../types/user';\n\nconst userRouter = Router();\n//const { validation } = middleware;\n\n// @GET '/auth'\n// @DEST Get user authenticated\n\nuserRouter.get(\n  '/',\n  middleware.userAuth,\n  //middleware.checkObjectId,\n  handler(async (req: any, res: any) => {  \n    // user.req always get from middleware    \n    const userService = Container.get(UserService);\n    const user = await userService.getUser(req.user.id);    \n    return res.status(200).json(user);\n  }),\n);\n\nuserRouter.get(\n  '/me',\n  middleware.userAuth,\n  handler(async (req: any, res: any) => {    \n    return res.status(200).json({ user: req.user , msg: 'hellow world'});\n  }),\n);\n\n// @POST '/auth'\n// @DES Login user\nuserRouter.post(\n  '/login',\n  //validation(UserSigninDto),\n  handler(\n    async (req: RequestUser, res: Response): Promise<void> => {\n      try {\n        const userService = Container.get(UserService);\n        const token = await userService.loginUser(req.body);\n        res.json({ token });  \n      } catch (error) {\n        console.log(error);\n      }      \n    },\n  ),\n);\n\n// @POST '/auth/users'\n// @DES Register user\nuserRouter.post(\n  '/',\n  //validation(UserSignupDto),\n  handler(\n    async (req: RequestUser, res: Response): Promise<void> => {\n      const userService = Container.get(UserService);\n      const token = await userService.registerUser(req.body);\n      res.json({ token });\n    },\n  ),\n);\n\nexport { userRouter };\nexport default userRouter;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f2a81db44a26564c7a06d9565e1db387bc8bba53","contentHash":"c1b38e56f56b191dd7685f1ee684cecee3a82f2fdf2290b09add6adfdf279275"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\services\\userService.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\services\\userService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":29}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":34}},"4":{"start":{"line":6,"column":16},"end":{"line":6,"column":47}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":46}},"6":{"start":{"line":8,"column":17},"end":{"line":8,"column":37}},"7":{"start":{"line":9,"column":26},"end":{"line":9,"column":66}},"8":{"start":{"line":10,"column":17},"end":{"line":10,"column":59}},"9":{"start":{"line":11,"column":19},"end":{"line":11,"column":63}},"10":{"start":{"line":12,"column":23},"end":{"line":12,"column":71}},"11":{"start":{"line":13,"column":28},"end":{"line":13,"column":81}},"12":{"start":{"line":14,"column":22},"end":{"line":14,"column":69}},"13":{"start":{"line":15,"column":18},"end":{"line":15,"column":36}},"14":{"start":{"line":18,"column":18},"end":{"line":124,"column":1}},"15":{"start":{"line":20,"column":8},"end":{"line":20,"column":35}},"16":{"start":{"line":21,"column":8},"end":{"line":21,"column":29}},"17":{"start":{"line":22,"column":8},"end":{"line":22,"column":29}},"18":{"start":{"line":23,"column":8},"end":{"line":23,"column":47}},"19":{"start":{"line":27,"column":8},"end":{"line":35,"column":11}},"20":{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},"21":{"start":{"line":29,"column":29},"end":{"line":29,"column":62}},"22":{"start":{"line":30,"column":16},"end":{"line":30,"column":28}},"23":{"start":{"line":33,"column":16},"end":{"line":33,"column":111}},"24":{"start":{"line":39,"column":8},"end":{"line":76,"column":11}},"25":{"start":{"line":40,"column":12},"end":{"line":75,"column":13}},"26":{"start":{"line":42,"column":35},"end":{"line":42,"column":97}},"27":{"start":{"line":43,"column":16},"end":{"line":46,"column":17}},"28":{"start":{"line":44,"column":20},"end":{"line":44,"column":80}},"29":{"start":{"line":45,"column":20},"end":{"line":45,"column":111}},"30":{"start":{"line":48,"column":32},"end":{"line":48,"column":102}},"31":{"start":{"line":49,"column":16},"end":{"line":52,"column":17}},"32":{"start":{"line":50,"column":20},"end":{"line":50,"column":80}},"33":{"start":{"line":51,"column":20},"end":{"line":51,"column":111}},"34":{"start":{"line":54,"column":32},"end":{"line":61,"column":17}},"35":{"start":{"line":62,"column":34},"end":{"line":62,"column":59}},"36":{"start":{"line":63,"column":16},"end":{"line":70,"column":17}},"37":{"start":{"line":64,"column":34},"end":{"line":64,"column":102}},"38":{"start":{"line":66,"column":20},"end":{"line":66,"column":33}},"39":{"start":{"line":69,"column":20},"end":{"line":69,"column":120}},"40":{"start":{"line":73,"column":16},"end":{"line":73,"column":71}},"41":{"start":{"line":74,"column":16},"end":{"line":74,"column":28}},"42":{"start":{"line":80,"column":8},"end":{"line":122,"column":11}},"43":{"start":{"line":81,"column":50},"end":{"line":81,"column":59}},"44":{"start":{"line":82,"column":12},"end":{"line":121,"column":13}},"45":{"start":{"line":83,"column":27},"end":{"line":83,"column":69}},"46":{"start":{"line":84,"column":16},"end":{"line":86,"column":17}},"47":{"start":{"line":85,"column":20},"end":{"line":85,"column":137}},"48":{"start":{"line":87,"column":16},"end":{"line":87,"column":63}},"49":{"start":{"line":88,"column":16},"end":{"line":90,"column":17}},"50":{"start":{"line":89,"column":20},"end":{"line":89,"column":131}},"51":{"start":{"line":92,"column":29},"end":{"line":92,"column":63}},"52":{"start":{"line":93,"column":36},"end":{"line":93,"column":79}},"53":{"start":{"line":94,"column":35},"end":{"line":98,"column":18}},"54":{"start":{"line":100,"column":32},"end":{"line":104,"column":17}},"55":{"start":{"line":105,"column":34},"end":{"line":105,"column":59}},"56":{"start":{"line":106,"column":16},"end":{"line":116,"column":17}},"57":{"start":{"line":107,"column":34},"end":{"line":107,"column":102}},"58":{"start":{"line":108,"column":20},"end":{"line":108,"column":73}},"59":{"start":{"line":109,"column":20},"end":{"line":109,"column":93}},"60":{"start":{"line":110,"column":20},"end":{"line":110,"column":61}},"61":{"start":{"line":111,"column":20},"end":{"line":111,"column":33}},"62":{"start":{"line":114,"column":20},"end":{"line":114,"column":78}},"63":{"start":{"line":115,"column":20},"end":{"line":115,"column":123}},"64":{"start":{"line":119,"column":16},"end":{"line":119,"column":74}},"65":{"start":{"line":120,"column":16},"end":{"line":120,"column":28}},"66":{"start":{"line":125,"column":0},"end":{"line":133,"column":16}},"67":{"start":{"line":134,"column":0},"end":{"line":134,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":60},"end":{"line":24,"column":5}},"line":19},"1":{"name":"(anonymous_1)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":16},"end":{"line":36,"column":5}},"line":26},"2":{"name":"(anonymous_2)","decl":{"start":{"line":27,"column":55},"end":{"line":27,"column":56}},"loc":{"start":{"line":27,"column":68},"end":{"line":35,"column":9}},"line":27},"3":{"name":"(anonymous_3)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":25},"end":{"line":77,"column":5}},"line":38},"4":{"name":"(anonymous_4)","decl":{"start":{"line":39,"column":55},"end":{"line":39,"column":56}},"loc":{"start":{"line":39,"column":68},"end":{"line":76,"column":9}},"line":39},"5":{"name":"(anonymous_5)","decl":{"start":{"line":79,"column":4},"end":{"line":79,"column":5}},"loc":{"start":{"line":79,"column":28},"end":{"line":123,"column":5}},"line":79},"6":{"name":"(anonymous_6)","decl":{"start":{"line":80,"column":55},"end":{"line":80,"column":56}},"loc":{"start":{"line":80,"column":68},"end":{"line":122,"column":9}},"line":80}},"branchMap":{"0":{"loc":{"start":{"line":43,"column":16},"end":{"line":46,"column":17}},"type":"if","locations":[{"start":{"line":43,"column":16},"end":{"line":46,"column":17}},{"start":{"line":43,"column":16},"end":{"line":46,"column":17}}],"line":43},"1":{"loc":{"start":{"line":49,"column":16},"end":{"line":52,"column":17}},"type":"if","locations":[{"start":{"line":49,"column":16},"end":{"line":52,"column":17}},{"start":{"line":49,"column":16},"end":{"line":52,"column":17}}],"line":49},"2":{"loc":{"start":{"line":84,"column":16},"end":{"line":86,"column":17}},"type":"if","locations":[{"start":{"line":84,"column":16},"end":{"line":86,"column":17}},{"start":{"line":84,"column":16},"end":{"line":86,"column":17}}],"line":84},"3":{"loc":{"start":{"line":88,"column":16},"end":{"line":90,"column":17}},"type":"if","locations":[{"start":{"line":88,"column":16},"end":{"line":90,"column":17}},{"start":{"line":88,"column":16},"end":{"line":90,"column":17}}],"line":88}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":0,"24":1,"25":1,"26":1,"27":1,"28":0,"29":0,"30":1,"31":1,"32":0,"33":0,"34":1,"35":1,"36":1,"37":1,"38":1,"39":0,"40":0,"41":0,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":1,"65":1,"66":1,"67":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"b":{"0":[0,1],"1":[0,1],"2":[1,0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/services/userService.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/services/userService.ts"],"names":[],"mappings":";;;;AAAA,mCAAyC;AACzC,gDAAiD;AACjD,+CAAmD;AACnD,sCAAmC;AAEnC,mEAGuC;AACvC,4DAA4B;AAC5B,gEAAgC;AAChC,wEAA+B;AAC/B,kFAA2C;AAC3C,sEAAsC;AACtC,qCAAiC;AACjC,8CAA8C;AAE9C,kBAAkB;AAElB,IAAa,WAAW,GAAxB,MAAa,WAAW;IACtB,YAEU,SAAoD,EACpD,MAAqB,EACH,MAAc,EAEhC,eAAyC;QAJzC,cAAS,GAAT,SAAS,CAA2C;QACpD,WAAM,GAAN,MAAM,CAAe;QACH,WAAM,GAAN,MAAM,CAAQ;QAEhC,oBAAe,GAAf,eAAe,CAA0B;IAEnD,CAAC;IAED,qBAAqB;IACR,OAAO,CAAC,EAAU;;YAC7B,IAAI;gBACF,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAC/C,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,KAAK,EAAE;gBACd,MAAM,qBAAW,CAAC,2BAAU,CAAC,SAAS,EAAE,QAAQ,EAAE,gBAAgB,CAAC,CAAC;aACrE;QACH,CAAC;KAAA;IAED,gBAAgB;IAEH,SAAS,CAAC,SAAqB;;YAC1C,IAAI;gBACF,mBAAmB;gBACnB,MAAM,SAAS,GAAG,CAAC,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;gBACnF,IAAI,CAAC,SAAS,EAAE;oBACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,wCAAwC,CAAC,CAAC;oBAC5D,MAAM,qBAAW,CAAC,2BAAU,CAAC,SAAS,EAAE,sBAAsB,CAAC,CAAC;iBACjE;gBACD,iBAAiB;gBACjB,MAAM,OAAO,GAAG,MAAM,gBAAM,CAAC,OAAO,CAClC,SAAS,CAAC,QAAQ,EAClB,SAAS,CAAC,QAAQ,CACnB,CAAC;gBACF,IAAI,CAAC,OAAO,EAAE;oBACZ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,wCAAwC,CAAC,CAAC;oBAC5D,MAAM,qBAAW,CAAC,2BAAU,CAAC,SAAS,EAAE,sBAAsB,CAAC,CAAC;iBACjE;gBAED,qBAAqB;gBACrB,MAAM,OAAO,GAAG;oBACd,IAAI,EAAE;wBACJ,EAAE,EAAE,SAAS,CAAC,EAAE;wBAChB,QAAQ,EAAE,SAAS,CAAC,QAAQ;wBAC5B,IAAI,EAAE,SAAS,CAAC,IAAI;wBACpB,KAAK,EAAE,SAAS,CAAC,KAAK;qBACvB;iBACF,CAAC;gBAEF,MAAM,SAAS,GAAG,eAAM,CAAC,SAAS,CAAC;gBACnC,IAAI;oBACF,MAAM,KAAK,GAAG,sBAAG,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;oBAChE,kEAAkE;oBAClE,OAAO,KAAK,CAAC;iBACd;gBAAC,OAAO,KAAK,EAAE;oBACd,MAAM,qBAAW,CACf,2BAAU,CAAC,SAAS,EACpB,+BAA+B,CAChC,CAAC;iBACH;aACF;YAAC,OAAO,KAAK,EAAE;gBACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAoB,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;gBACvD,MAAM,KAAK,CAAC;aACb;QACH,CAAC;KAAA;IAED,mBAAmB;IACN,YAAY,CAAC,SAAqB;;YAC7C,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,SAAS,CAAC;YAChD,IAAI;gBACF,IAAI,IAAI,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,CAAC,CAAC;gBACtD,IAAI,IAAI,EAAE;oBACR,MAAM,qBAAW,CACf,2BAAU,CAAC,QAAQ,EACnB,wBAAwB,QAAQ,iBAAiB,CAClD,CAAC;iBACH;gBACD,IAAI,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;gBAC/C,IAAI,IAAI,EAAE;oBACR,MAAM,qBAAW,CACf,2BAAU,CAAC,QAAQ,EACnB,qBAAqB,KAAK,iBAAiB,CAC5C,CAAC;iBACH;gBAED,sBAAsB;gBACtB,MAAM,IAAI,GAAG,MAAM,gBAAM,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;gBACtC,MAAM,WAAW,GAAG,MAAM,gBAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACtD,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;oBAC7C,QAAQ,EAAE,QAAQ;oBAClB,KAAK,EAAE,KAAK;oBACZ,QAAQ,EAAE,WAAW;iBACtB,CAAC,CAAC;gBACH,kBAAkB;gBAClB,MAAM,OAAO,GAAG;oBACd,IAAI,EAAE;wBACJ,EAAE,EAAE,UAAU,CAAC,EAAE;qBAClB;iBACF,CAAC;gBACF,MAAM,SAAS,GAAG,eAAM,CAAC,SAAS,CAAC;gBACnC,IAAI;oBACF,MAAM,KAAK,GAAG,sBAAG,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;oBAChE,MAAM,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;oBACrD,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,iBAAS,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;oBACjE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;oBACzC,OAAO,KAAK,CAAC;iBACd;gBAAC,OAAO,KAAK,EAAE;oBACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,uBAAuB,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;oBAC1D,MAAM,qBAAW,CACf,2BAAU,CAAC,SAAS,EACpB,kCAAkC,CACnC,CAAC;iBACH;aACF;YAAC,OAAO,KAAK,EAAE;gBACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,uBAAuB,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;gBAC1D,MAAM,KAAK,CAAC;aACb;QACH,CAAC;KAAA;CACF,CAAA;AAxHY,WAAW;IADvB,gBAAO,EAAE;IAGL,mBAAA,eAAM,CAAC,WAAW,CAAC,CAAA;IAGnB,mBAAA,eAAM,CAAC,QAAQ,CAAC,CAAA;IAChB,mBAAA,iCAAe,EAAE,CAAA;6CAHC,kBAAQ,CAAC,KAAK,EACjB,sBAAa;QACK,gBAAM;QAEf,0CAAwB;GAPxC,WAAW,CAwHvB;AAxHY,kCAAW","sourcesContent":["import { Service, Inject } from 'typedi';\r\nimport { AppEvents } from '../subscribers/event';\r\nimport { MailerService } from '../services/mailer';\r\nimport { config } from '../config';\r\nimport { IUser, IUserInput, IUserService } from '../types/user';\r\nimport {\r\n  EventDispatcher,\r\n  EventDispatcherInterface,\r\n} from '../decorators/eventDispatcher';\r\nimport bcrypt from 'bcrypt';\r\nimport mongoose from 'mongoose';\r\nimport jwt from 'jsonwebtoken';\r\nimport httpStatus from 'http-status-codes';\r\nimport createError from 'http-errors';\r\nimport { Logger } from 'winston';\r\n//import { UserModel } from '../models/users';\r\n\r\n/* User service */\r\n@Service()\r\nexport class UserService implements IUserService {\r\n  constructor(    \r\n    @Inject('userModel')\r\n    private userModel: mongoose.Model<IUser & mongoose.Document>,\r\n    private mailer: MailerService,\r\n    @Inject('logger') private logger: Logger,    \r\n    @EventDispatcher()\r\n    private eventDispatcher: EventDispatcherInterface,\r\n  ) {       \r\n  }\r\n\r\n  /* Get user from id*/\r\n  public async getUser(id: string): Promise<IUser> {\r\n    try {\r\n      const user = await this.userModel.findById(id);\r\n      return user;\r\n    } catch (error) {\r\n      throw createError(httpStatus.NOT_FOUND, `User ${id} doesn't exist`);\r\n    }\r\n  }\r\n\r\n  /* Login user */\r\n\r\n  public async loginUser(userInput: IUserInput) {    \r\n    try {\r\n      // Get user from db\r\n      const userCheck = (await this.userModel.findOne({ username: userInput.username }));      \r\n      if (!userCheck) {\r\n        this.logger.debug('Warning loginUser: InValid credentials');\r\n        throw createError(httpStatus.FORBIDDEN, `Invalid  credentials`);\r\n      }\r\n      // Check password\r\n      const isMatch = await bcrypt.compare(\r\n        userInput.password,\r\n        userCheck.password,\r\n      );\r\n      if (!isMatch) {\r\n        this.logger.debug('Warning loginUser: InValid credentials');\r\n        throw createError(httpStatus.FORBIDDEN, `Invalid  credentials`);\r\n      }\r\n\r\n      //Return jsonwebtoken\r\n      const payload = {\r\n        user: {\r\n          id: userCheck.id,\r\n          username: userCheck.username,\r\n          role: userCheck.role,\r\n          email: userCheck.email\r\n        },\r\n      };\r\n      \r\n      const jwtSecret = config.jwtSecret;\r\n      try {\r\n        const token = jwt.sign(payload, jwtSecret, { expiresIn: '2h' });\r\n        //this.eventDispatcher.dispatch(AppEvents.user.signIn, userCheck);\r\n        return token;\r\n      } catch (error) {\r\n        throw createError(\r\n          httpStatus.FORBIDDEN,\r\n          `loginUser: Error jsonwebtoken`,\r\n        );\r\n      }\r\n    } catch (error) {\r\n      this.logger.error(`Error loginUser: ${error.message}`);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /* Register user */\r\n  public async registerUser(userInput: IUserInput) {\r\n    const { username, email, password } = userInput;\r\n    try {      \r\n      let user = await this.userModel.findOne({ username });\r\n      if (user) {\r\n        throw createError(\r\n          httpStatus.CONFLICT,\r\n          `A user with username ${username} already exists`,\r\n        );\r\n      }\r\n      user = await this.userModel.findOne({ email });\r\n      if (user) {\r\n        throw createError(\r\n          httpStatus.CONFLICT,\r\n          `A user with email ${email} already exists`,\r\n        );\r\n      }\r\n      \r\n      // Encrypting password\r\n      const salt = await bcrypt.genSalt(10);\r\n      const encryptPass = await bcrypt.hash(password, salt);      \r\n      const userRecord = await this.userModel.create({\r\n        username: username,\r\n        email: email,\r\n        password: encryptPass,\r\n      });      \r\n      // Return password\r\n      const payload = {\r\n        user: {\r\n          id: userRecord.id,\r\n        },\r\n      };\r\n      const jwtSecret = config.jwtSecret;\r\n      try {\r\n        const token = jwt.sign(payload, jwtSecret, { expiresIn: '2h' });\r\n        await this.mailer.SendWelcomeEmail(userRecord.email);\r\n        this.eventDispatcher.dispatch(AppEvents.user.signUp, userRecord);\r\n        this.logger.info('Success registerUser');\r\n        return token;\r\n      } catch (error) {        \r\n        this.logger.error(`Error registerUser: ${error.message}`);\r\n        throw createError(\r\n          httpStatus.FORBIDDEN,\r\n          `RegisterUser: Error jsonwebtoken`,\r\n        );\r\n      }\r\n    } catch (error) {      \r\n      this.logger.error(`Error registerUser: ${error.message}`);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"171f4cec6b54ac826b71b9427a4d03d9d424b1d2","contentHash":"d1f809341127f7229582683eebf6b991a18d68c539ca84d69830d9514a51c9d1"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\subscribers\\event.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\subscribers\\event.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":4,"column":18},"end":{"line":9,"column":1}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":30}},"4":{"start":{"line":11,"column":0},"end":{"line":11,"column":28}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/subscribers/event.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/subscribers/event.ts"],"names":[],"mappings":";;;AAAA,MAAM,SAAS,GAAG;IAChB,IAAI,EAAE;QACJ,MAAM,EAAE,cAAc;QACtB,MAAM,EAAE,cAAc;KACvB;CACF,CAAC;AACO,8BAAS;AAElB,kBAAe,SAAS,CAAC","sourcesContent":["const AppEvents = {\n  user: {\n    signUp: 'onUserSignUp',\n    signIn: 'onUserSignIn',\n  },\n};\nexport { AppEvents };\n\nexport default AppEvents;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"883eb5f6368dd0286fb65b60709aa8bc4eabfcce","contentHash":"a1eed71b27995afe4146351d3c3ecb166313f241a4cd20e1e164b73127148e21"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\services\\mailer.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\services\\mailer.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":34}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":34}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},"6":{"start":{"line":8,"column":20},"end":{"line":47,"column":1}},"7":{"start":{"line":10,"column":8},"end":{"line":10,"column":39}},"8":{"start":{"line":11,"column":8},"end":{"line":11,"column":55}},"9":{"start":{"line":14,"column":8},"end":{"line":32,"column":11}},"10":{"start":{"line":16,"column":24},"end":{"line":22,"column":13}},"11":{"start":{"line":23,"column":12},"end":{"line":30,"column":15}},"12":{"start":{"line":26,"column":16},"end":{"line":26,"column":71}},"13":{"start":{"line":29,"column":16},"end":{"line":29,"column":56}},"14":{"start":{"line":31,"column":12},"end":{"line":31,"column":50}},"15":{"start":{"line":35,"column":8},"end":{"line":37,"column":9}},"16":{"start":{"line":36,"column":12},"end":{"line":36,"column":49}},"17":{"start":{"line":45,"column":8},"end":{"line":45,"column":46}},"18":{"start":{"line":48,"column":0},"end":{"line":52,"column":18}},"19":{"start":{"line":53,"column":0},"end":{"line":53,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":29},"end":{"line":12,"column":5}},"line":9},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":28},"end":{"line":33,"column":5}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":55},"end":{"line":14,"column":56}},"loc":{"start":{"line":14,"column":68},"end":{"line":32,"column":9}},"line":14},"3":{"name":"(anonymous_3)","decl":{"start":{"line":25,"column":22},"end":{"line":25,"column":23}},"loc":{"start":{"line":25,"column":28},"end":{"line":27,"column":13}},"line":25},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":23},"end":{"line":28,"column":24}},"loc":{"start":{"line":28,"column":32},"end":{"line":30,"column":13}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":39},"end":{"line":46,"column":5}},"line":34}},"branchMap":{"0":{"loc":{"start":{"line":35,"column":8},"end":{"line":37,"column":9}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":37,"column":9}},{"start":{"line":35,"column":8},"end":{"line":37,"column":9}}],"line":35}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":1},"f":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/services/mailer.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/services/mailer.ts"],"names":[],"mappings":";;;;AACA,mCAAyC;AAEzC,mCAAmC;AACnC,sCAAmC;AAGnC,IAAa,aAAa,GAA1B,MAAa,aAAa;IACxB,YAA2C,WAAW;QAAX,gBAAW,GAAX,WAAW,CAAA;QACtD,WAAM,GAAW,kBAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IADgB,CAAC;IAE7C,gBAAgB,CAAC,KAAa;;YACzC,6CAA6C;YAC7C,MAAM,GAAG,GAAG;gBACV,IAAI,EAAE,eAAM,CAAC,MAAM,CAAC,MAAM;gBAC1B,EAAE,EAAE,KAAK;gBACT,OAAO,EAAE,qBAAqB;gBAC9B,IAAI,EAAE,+BAA+B;gBACrC,IAAI,EAAE,6DAA6D;aACpE,CAAC;YACF,IAAI,CAAC,WAAW;iBACb,IAAI,CAAC,GAAG,CAAC;iBACT,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,6BAA6B,KAAK,EAAE,CAAC,CAAC;YACzD,CAAC,CAAC;iBACD,KAAK,CAAC,KAAK,CAAC,EAAE;gBACb,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,KAAK,EAAE,CAAC,CAAC;YAC1C,CAAC,CAAC,CAAC;YAEL,OAAO,EAAE,SAAS,EAAE,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;QACxC,CAAC;KAAA;IAEM,kBAAkB,CAAC,QAAgB,EAAE,IAAoB;QAC9D,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;YACf,MAAM,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;SACtC;QACD,wDAAwD;QACxD,iBAAiB;QACjB,uCAAuC;QACvC,gDAAgD;QAChD,4DAA4D;QAC5D,oDAAoD;QACpD,qDAAqD;QACrD,OAAO,EAAE,SAAS,EAAE,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;IACxC,CAAC;CACF,CAAA;AArCY,aAAa;IADzB,gBAAO,EAAE;IAEK,mBAAA,eAAM,CAAC,aAAa,CAAC,CAAA;;GADvB,aAAa,CAqCzB;AArCY,sCAAa","sourcesContent":["import { IUser } from '../types/user';\nimport { Service, Inject } from 'typedi';\nimport { Logger } from 'winston';\nimport { Container } from 'typedi';\nimport { config } from '../config';\n\n@Service()\nexport class MailerService {\n  constructor(@Inject('emailClient') private emailClient) {}\n  Logger: Logger = Container.get('logger');\n  public async SendWelcomeEmail(email: string) {\n    // Add example for sending mail from sendgrid\n    const msg = {\n      from: config.emails.sender,\n      to: email,\n      subject: 'Welcome to our page',\n      text: 'Sending with SENDGRID is fun!',\n      html: '<strong>and easy to do anywhere, even with Node.js</strong>',\n    };\n    this.emailClient\n      .send(msg)\n      .then(() => {\n        this.Logger.info(`An email has been send to ${email}`);\n      })\n      .catch(error => {\n        this.Logger.error(`Sendgrid: ${error}`);\n      });\n\n    return { delivered: 1, status: 'ok' };\n  }\n\n  public StartEmailSequence(sequence: string, user: Partial<IUser>) {\n    if (!user.email) {\n      throw new Error('No email provided');\n    }\n    // @TODO Add example of an email sequence implementation\n    // Something like\n    // 1 - Send first email of the sequence\n    // 2 - Save the step of the sequence in database\n    // 3 - Schedule job for second email in 1-3 days or whatever\n    // Every sequence can have its own behavior so maybe\n    // the pattern Chain of Responsibility can help here.\n    return { delivered: 1, status: 'ok' };\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"43c7b23d270beae7b054fa683b9b9ee6837f70f5","contentHash":"c55de483b31920c4d73fb20c3a522fde7ef63580d1061bd6f8e473ce15760ee9"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\decorators\\eventDispatcher.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\decorators\\eventDispatcher.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":68}},"2":{"start":{"line":4,"column":25},"end":{"line":4,"column":50}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":34}},"4":{"start":{"line":6,"column":24},"end":{"line":16,"column":1}},"5":{"start":{"line":7,"column":4},"end":{"line":15,"column":6}},"6":{"start":{"line":8,"column":32},"end":{"line":8,"column":70}},"7":{"start":{"line":9,"column":8},"end":{"line":14,"column":11}},"8":{"start":{"line":13,"column":25},"end":{"line":13,"column":40}},"9":{"start":{"line":17,"column":0},"end":{"line":17,"column":42}},"10":{"start":{"line":18,"column":23},"end":{"line":18,"column":48}},"11":{"start":{"line":19,"column":0},"end":{"line":19,"column":144}},"12":{"start":{"line":19,"column":98},"end":{"line":19,"column":138}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":24},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":30},"end":{"line":16,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":11},"end":{"line":7,"column":12}},"loc":{"start":{"line":7,"column":44},"end":{"line":15,"column":5}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":19},"end":{"line":13,"column":20}},"loc":{"start":{"line":13,"column":25},"end":{"line":13,"column":40}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":84},"end":{"line":19,"column":85}},"loc":{"start":{"line":19,"column":96},"end":{"line":19,"column":140}},"line":19}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1},"f":{"0":1,"1":1,"2":1,"3":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/decorators/eventDispatcher.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/decorators/eventDispatcher.ts"],"names":[],"mappings":";;;AAAA,mDAAyE;AACzE,mCAAmC;AAE5B,MAAM,eAAe,GAAG,GAAG,EAAE;IAClC,OAAO,CAAC,MAAW,EAAE,YAAoB,EAAE,KAAc,EAAQ,EAAE;QACjE,MAAM,eAAe,GAAG,IAAI,gCAAoB,EAAE,CAAC;QACnD,kBAAS,CAAC,eAAe,CAAC;YACxB,MAAM;YACN,YAAY;YACZ,KAAK;YACL,KAAK,EAAE,GAAG,EAAE,CAAC,eAAe;SAC7B,CAAC,CAAC;IACL,CAAC,CAAC;AACJ,CAAC,CAAC;AAVW,QAAA,eAAe,mBAU1B;AACF,iDAA6E;AAApE,0HAAA,eAAe,OAA4B","sourcesContent":["import { EventDispatcher as EventDispatcherClass } from 'event-dispatch';\nimport { Container } from 'typedi';\n\nexport const EventDispatcher = () => {\n  return (object: any, propertyName: string, index?: number): void => {\n    const eventDispatcher = new EventDispatcherClass();\n    Container.registerHandler({\n      object,\n      propertyName,\n      index,\n      value: () => eventDispatcher,\n    });\n  };\n};\nexport { EventDispatcher as EventDispatcherInterface } from 'event-dispatch';\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"01264fb952a213fce777fcf89049b273c980da88","contentHash":"b524317a15fd9cea6f61b5a0bb806110c7e2658fac275ee04a3ddfce269b1095"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\index.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":4,"column":19},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":23},"end":{"line":5,"column":48}},"4":{"start":{"line":6,"column":24},"end":{"line":6,"column":50}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":40}},"6":{"start":{"line":8,"column":23},"end":{"line":8,"column":48}},"7":{"start":{"line":9,"column":21},"end":{"line":9,"column":44}},"8":{"start":{"line":10,"column":0},"end":{"line":17,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/index.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/index.ts"],"names":[],"mappings":";;;AAAA,yCAAsC;AACtC,iDAA+C;AAC/C,mDAAgD;AAChD,yCAAsC;AACtC,iDAA8C;AAC9C,6CAA0C;AAE7B,QAAA,UAAU,GAAG;IACxB,QAAQ,EAAR,mBAAQ;IACR,aAAa,EAAb,4BAAa;IACb,aAAa,EAAb,6BAAa;IACb,QAAQ,EAAR,mBAAQ;IACR,YAAY,EAAZ,2BAAY;IACZ,UAAU,EAAV,uBAAU;CACX,CAAC","sourcesContent":["import { userAuth } from './userAuth';\nimport { checkObjectId } from './checkIdMongo';\nimport { requestLogger } from './requestLogger';\nimport { notFound } from './notFound';\nimport { errorRequest } from './errorRequest';\nimport { validation } from './validation';\n\nexport const middleware = {\n  userAuth,\n  checkObjectId,\n  requestLogger,\n  notFound,\n  errorRequest,\n  validation,\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a8c8bcb7c06b5c517899f309bd00cb0a88cadfe4","contentHash":"71d9966d7ada33240c1efe50c18d21c370f5a3049716621a5bf70851b89e68ef"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\userAuth.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\userAuth.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":26}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":23},"end":{"line":5,"column":71}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":37}},"5":{"start":{"line":7,"column":28},"end":{"line":7,"column":81}},"6":{"start":{"line":8,"column":32},"end":{"line":8,"column":89}},"7":{"start":{"line":9,"column":22},"end":{"line":9,"column":69}},"8":{"start":{"line":10,"column":17},"end":{"line":24,"column":3}},"9":{"start":{"line":10,"column":69},"end":{"line":24,"column":2}},"10":{"start":{"line":11,"column":18},"end":{"line":11,"column":44}},"11":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"12":{"start":{"line":13,"column":8},"end":{"line":13,"column":111}},"13":{"start":{"line":15,"column":22},"end":{"line":15,"column":47}},"14":{"start":{"line":16,"column":4},"end":{"line":23,"column":7}},"15":{"start":{"line":17,"column":8},"end":{"line":20,"column":9}},"16":{"start":{"line":18,"column":12},"end":{"line":18,"column":100}},"17":{"start":{"line":19,"column":12},"end":{"line":19,"column":19}},"18":{"start":{"line":21,"column":8},"end":{"line":21,"column":32}},"19":{"start":{"line":22,"column":8},"end":{"line":22,"column":15}},"20":{"start":{"line":25,"column":0},"end":{"line":25,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":10,"column":49},"end":{"line":10,"column":50}},"loc":{"start":{"line":10,"column":69},"end":{"line":24,"column":2}},"line":10},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":111},"end":{"line":10,"column":112}},"loc":{"start":{"line":10,"column":124},"end":{"line":24,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":52},"end":{"line":16,"column":53}},"loc":{"start":{"line":16,"column":76},"end":{"line":23,"column":5}},"line":16}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":14,"column":5}},{"start":{"line":12,"column":4},"end":{"line":14,"column":5}}],"line":12},"1":{"loc":{"start":{"line":17,"column":8},"end":{"line":20,"column":9}},"type":"if","locations":[{"start":{"line":17,"column":8},"end":{"line":20,"column":9}},{"start":{"line":17,"column":8},"end":{"line":20,"column":9}}],"line":17}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":0,"13":2,"14":2,"15":2,"16":0,"17":0,"18":2,"19":2,"20":1},"f":{"0":2,"1":2,"2":2},"b":{"0":[0,2],"1":[0,2]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/userAuth.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/userAuth.ts"],"names":[],"mappings":";;;;AACA,wEAA+B;AAE/B,sCAAmC;AACnC,kFAA2C;AAC3C,0FAA4C;AAC5C,sEAAsC;AAEtC,MAAM,QAAQ,GAAmB,+BAAO,CACtC,CAAO,GAAgB,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC5D,MAAM,KAAK,GAAW,GAAG,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;IACjD,IAAI,CAAC,KAAK,EAAE;QACV,IAAI,CACF,qBAAW,CAAC,2BAAU,CAAC,WAAW,EAAE,gCAAgC,CAAC,CACtE,CAAC;KACH;IAED,MAAM,SAAS,GAAG,eAAM,CAAC,SAAS,CAAC;IACnC,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,EAAE,UAAU,GAAG,EAAE,OAAO;QACjD,IAAI,GAAG,EAAE;YACP,IAAI,CAAC,qBAAW,CAAC,2BAAU,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC,CAAC;YAC7D,OAAO;SACR;QACD,GAAG,CAAC,IAAI,GAAI,OAAuB,CAAC,IAAI,CAAC;QACzC,IAAI,EAAE,CAAC;IACT,CAAC,CAAC,CAAC;AACL,CAAC,CAAA,CACF,CAAC;AAEO,4BAAQ","sourcesContent":["import { Response, NextFunction, RequestHandler } from 'express';\r\nimport jwt from 'jsonwebtoken';\r\nimport { RequestUser } from '../types/user';\r\nimport { config } from '../config';\r\nimport httpStatus from 'http-status-codes';\r\nimport handler from 'express-async-handler';\r\nimport createError from 'http-errors';\r\n\r\nconst userAuth: RequestHandler = handler(\r\n  async (req: RequestUser, res: Response, next: NextFunction) => {\r\n    const token: string = req.header('x-auth-token');\r\n    if (!token) {\r\n      next(\r\n        createError(httpStatus.BAD_REQUEST, 'No token, authorization denied'),\r\n      );\r\n    }\r\n\r\n    const jwtSecret = config.jwtSecret;\r\n    jwt.verify(token, jwtSecret, function (err, decoded) {\r\n      if (err) {\r\n        next(createError(httpStatus.BAD_REQUEST, 'Token not valid'));\r\n        return;\r\n      }\r\n      req.user = (decoded as RequestUser).user;\r\n      next();\r\n    });\r\n  },\r\n);\r\n\r\nexport { userAuth };\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"95bd0929644e0371e1066142557016e4c23c1b89","contentHash":"ca84bb244b90514b6bc37ed695f98359a155e63867bc525f857e9657f6fef7a6"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\checkIdMongo.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\checkIdMongo.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":63}},"4":{"start":{"line":6,"column":22},"end":{"line":11,"column":1}},"5":{"start":{"line":6,"column":30},"end":{"line":11,"column":1}},"6":{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},"7":{"start":{"line":8,"column":8},"end":{"line":8,"column":52}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":11}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":22},"end":{"line":6,"column":23}},"loc":{"start":{"line":6,"column":30},"end":{"line":11,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":30},"end":{"line":6,"column":31}},"loc":{"start":{"line":6,"column":50},"end":{"line":11,"column":1}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},"type":"if","locations":[{"start":{"line":7,"column":4},"end":{"line":9,"column":5}},{"start":{"line":7,"column":4},"end":{"line":9,"column":5}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1},"f":{"0":0,"1":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/checkIdMongo.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/checkIdMongo.ts"],"names":[],"mappings":";;;;AAAA,gEAAgC;AAGzB,MAAM,aAAa,GAAG,CAAC,EAAU,EAAE,EAAE,CAAC,CAC3C,GAAY,EACZ,GAAa,EACb,IAAkB,EACZ,EAAE;IACR,IAAI,CAAC,kBAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,EAAE;QACpD,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,YAAY,EAAE,CAAC,CAAC;KAC7C;IACD,IAAI,EAAE,CAAC;AACT,CAAC,CAAC;AATW,QAAA,aAAa,iBASxB","sourcesContent":["import mongoose from 'mongoose';\nimport { Request, Response, NextFunction } from 'express';\n\nexport const checkObjectId = (id: string) => (\n  req: Request,\n  res: Response,\n  next: NextFunction,\n): void => {\n  if (!mongoose.Types.ObjectId.isValid(req.params[id])) {\n    res.status(400).json({ msg: 'Invalid id' });\n  }\n  next();\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8216f647e1fde804934347fd1110bb2ea9d09361","contentHash":"0cdb840be8f20f7bc06c326b712c13d2009adc24a6783a9b93a338f81f0032d3"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\requestLogger.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\requestLogger.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":59}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":43}},"5":{"start":{"line":10,"column":0},"end":{"line":16,"column":3}},"6":{"start":{"line":13,"column":12},"end":{"line":13,"column":48}},"7":{"start":{"line":17,"column":0},"end":{"line":17,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":8},"end":{"line":12,"column":9}},"loc":{"start":{"line":12,"column":19},"end":{"line":14,"column":9}},"line":12}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":6,"7":1},"f":{"0":6},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/requestLogger.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/requestLogger.ts"],"names":[],"mappings":";;;;AAAA,4DAA4B;AAC5B,4CAAyC;AAEzC;;GAEG;AACU,QAAA,aAAa,GAAG,gBAAM,CAAC,MAAM,EAAE;IAC1C,MAAM,EAAE;QACN,KAAK,CAAC,GAAW;YACf,eAAM,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;QAC7B,CAAC;KACF;CACF,CAAC,CAAC;AAEH,kBAAe,qBAAa,CAAC","sourcesContent":["import morgan from 'morgan';\nimport { logger } from '../utils/logger';\n\n/**\n * Middleware logging every API calls\n */\nexport const requestLogger = morgan('tiny', {\n  stream: {\n    write(msg: string) {\n      logger.http(msg.trimEnd());\n    },\n  },\n});\n\nexport default requestLogger;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"35b4f28667abcdddb9a71556d28698434d765c9c","contentHash":"9fdb73ffd9b77bc3e054877887326d95570a6654461c7847daaadbcdd4a3ebf2"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\notFound.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\notFound.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":26}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":28},"end":{"line":5,"column":81}},"4":{"start":{"line":6,"column":22},"end":{"line":6,"column":69}},"5":{"start":{"line":14,"column":17},"end":{"line":14,"column":127}},"6":{"start":{"line":14,"column":37},"end":{"line":14,"column":127}},"7":{"start":{"line":15,"column":0},"end":{"line":15,"column":28}},"8":{"start":{"line":16,"column":0},"end":{"line":16,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":17},"end":{"line":14,"column":18}},"loc":{"start":{"line":14,"column":37},"end":{"line":14,"column":127}},"line":14}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/notFound.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/notFound.ts"],"names":[],"mappings":";;;;AACA,kFAA2C;AAC3C,sEAAsC;AAEtC;;;;;;GAMG;AACH,MAAM,QAAQ,GAAmB,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,CAClD,IAAI,CAAC,qBAAW,CAAC,2BAAU,CAAC,SAAS,EAAE,GAAG,GAAG,CAAC,GAAG,YAAY,CAAC,CAAC,CAAC;AAEzD,4BAAQ;AACjB,kBAAe,QAAQ,CAAC","sourcesContent":["import { RequestHandler } from 'express';\nimport httpStatus from 'http-status-codes';\nimport createError from 'http-errors';\n\n/**\n * Middleware always throwing a 404 error\n * Need to be injected into express middlewares AFTER the router,\n * so as every requests not handled by the router are trapped here\n *\n * @throws 404 - Not found\n */\nconst notFound: RequestHandler = (req, res, next) =>\n  next(createError(httpStatus.NOT_FOUND, `${req.url} not found`));\n\nexport { notFound };\nexport default notFound;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f51f70c73a7fdcda7662d93fd20141fec0bf279c","contentHash":"95e970886ec753a20277c69b85b0160a4cf0787447c7ee99932938a51f1a2207"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\errorRequest.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\errorRequest.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":30}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":22},"end":{"line":5,"column":69}},"4":{"start":{"line":6,"column":28},"end":{"line":6,"column":81}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":43}},"6":{"start":{"line":8,"column":16},"end":{"line":8,"column":41}},"7":{"start":{"line":17,"column":21},"end":{"line":26,"column":1}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":39}},"9":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"10":{"start":{"line":22,"column":8},"end":{"line":22,"column":38}},"11":{"start":{"line":24,"column":19},"end":{"line":24,"column":119}},"12":{"start":{"line":25,"column":4},"end":{"line":25,"column":66}},"13":{"start":{"line":27,"column":0},"end":{"line":27,"column":36}},"14":{"start":{"line":28,"column":0},"end":{"line":28,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":17,"column":21},"end":{"line":17,"column":22}},"loc":{"start":{"line":17,"column":43},"end":{"line":26,"column":1}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":23,"column":5}},{"start":{"line":21,"column":4},"end":{"line":23,"column":5}}],"line":21},"1":{"loc":{"start":{"line":24,"column":19},"end":{"line":24,"column":119}},"type":"cond-expr","locations":[{"start":{"line":24,"column":65},"end":{"line":24,"column":67}},{"start":{"line":24,"column":70},"end":{"line":24,"column":119}}],"line":24},"2":{"loc":{"start":{"line":24,"column":19},"end":{"line":24,"column":62}},"type":"binary-expr","locations":[{"start":{"line":24,"column":19},"end":{"line":24,"column":45}},{"start":{"line":24,"column":49},"end":{"line":24,"column":62}}],"line":24}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":1,"12":1,"13":1,"14":1},"f":{"0":1},"b":{"0":[0,1],"1":[1,0],"2":[1,1]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/errorRequest.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/errorRequest.ts"],"names":[],"mappings":";;;;AAAA,sEAAsC;AAEtC,kFAA2C;AAE3C,4CAAoD;AACpD,0CAAyC;AAEzC;;;;;;;GAOG;AACH,MAAM,YAAY,GAAwB,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE;;IAC7D,eAAM,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;IAC1B,uFAAuF;IACvF,IAAI,CAAC,qBAAW,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE;QACjC,kBAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;KACtB;IACD,MAAM,MAAM,GAAG,MAAA,GAAG,CAAC,MAAM,mCAAI,2BAAU,CAAC,qBAAqB,CAAC;IAC9D,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,eAAO,CAAC,MAAM,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;AACxD,CAAC,CAAC;AAEO,oCAAY;AAErB,kBAAe,YAAY,CAAC","sourcesContent":["import createError from 'http-errors';\nimport type { ErrorRequestHandler } from 'express';\nimport httpStatus from 'http-status-codes';\n\nimport { logger, loggerDev } from '../utils/logger';\nimport { ErrorRo } from '../types/appRo';\n\n/**\n * Error middleware\n * Every error thrown in a route ends up here to be sent to the user\n * They are formatted into a generic RO, to have uniform error replies\n *\n * Not wanted errors (for example, a crash in the route) are\n * converted into a 500 - Internal server errors\n */\nconst errorRequest: ErrorRequestHandler = (err, req, res, _) => {\n  logger.error(err.message);\n  // If the error is not an HTTP error, the whole object is printed through console.error\n  if (!createError.isHttpError(err)) {\n    loggerDev.error(err);\n  }\n  const status = err.status ?? httpStatus.INTERNAL_SERVER_ERROR;\n  res.status(status).send(ErrorRo(status, err.message));\n};\n\nexport { errorRequest };\n\nexport default errorRequest;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d9606dea3bd25c9e2c4caffc1bd077a167c0e055","contentHash":"ee9729e81aa8a534f6c5cdd10a5123fdb43201b0f646d13f1b482ccc23414d0c"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\types\\appRo.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\types\\appRo.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":12,"column":4},"end":{"line":17,"column":6}},"3":{"start":{"line":19,"column":0},"end":{"line":19,"column":26}}},"fnMap":{"0":{"name":"ErrorRo","decl":{"start":{"line":11,"column":9},"end":{"line":11,"column":16}},"loc":{"start":{"line":11,"column":38},"end":{"line":18,"column":1}},"line":11}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/types/appRo.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/types/appRo.ts"],"names":[],"mappings":";;;AAWA;;;;;;GAMG;AACH,SAAgB,OAAO,CAAC,UAAkB,EAAE,OAAe;IACzD,OAAO;QACL,KAAK,EAAE;YACL,UAAU;YACV,OAAO;SACR;KACF,CAAC;AACJ,CAAC;AAPD,0BAOC","sourcesContent":["/**\n * Basic interface representing a Response Object (RO), from which all ROs inherits\n * It may contains an error and enable API consumer to treat every responses the same way\n */\nexport interface Ro {\n  error?: {\n    statusCode: number;\n    message: string;\n  };\n}\n\n/**\n * Construct a basic error RO\n *\n * @param statusCode HTTP status code\n * @param message Error message\n * @constructor\n */\nexport function ErrorRo(statusCode: number, message: string): Ro {\n  return {\n    error: {\n      statusCode,\n      message,\n    },\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"45873a96c4b9d2ee16dd186089a4065d937ecbac","contentHash":"36988c65cb0ea152996dc03e62d90de358aee6701038c31312fb8c8a72715fa1"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\validation.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\middleware\\validation.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":28},"end":{"line":5,"column":56}},"4":{"start":{"line":6,"column":26},"end":{"line":6,"column":52}},"5":{"start":{"line":7,"column":28},"end":{"line":7,"column":81}},"6":{"start":{"line":8,"column":22},"end":{"line":8,"column":69}},"7":{"start":{"line":9,"column":32},"end":{"line":9,"column":89}},"8":{"start":{"line":35,"column":4},"end":{"line":46,"column":8}},"9":{"start":{"line":35,"column":63},"end":{"line":46,"column":6}},"10":{"start":{"line":36,"column":27},"end":{"line":36,"column":75}},"11":{"start":{"line":37,"column":23},"end":{"line":37,"column":67}},"12":{"start":{"line":38,"column":8},"end":{"line":45,"column":9}},"13":{"start":{"line":39,"column":28},"end":{"line":39,"column":53}},"14":{"start":{"line":40,"column":12},"end":{"line":40,"column":90}},"15":{"start":{"line":43,"column":12},"end":{"line":43,"column":34}},"16":{"start":{"line":44,"column":12},"end":{"line":44,"column":19}},"17":{"start":{"line":48,"column":0},"end":{"line":48,"column":32}},"18":{"start":{"line":49,"column":0},"end":{"line":49,"column":29}}},"fnMap":{"0":{"name":"validation","decl":{"start":{"line":34,"column":9},"end":{"line":34,"column":19}},"loc":{"start":{"line":34,"column":26},"end":{"line":47,"column":1}},"line":34},"1":{"name":"(anonymous_1)","decl":{"start":{"line":35,"column":43},"end":{"line":35,"column":44}},"loc":{"start":{"line":35,"column":63},"end":{"line":46,"column":6}},"line":35},"2":{"name":"(anonymous_2)","decl":{"start":{"line":35,"column":103},"end":{"line":35,"column":104}},"loc":{"start":{"line":35,"column":116},"end":{"line":46,"column":5}},"line":35}},"branchMap":{"0":{"loc":{"start":{"line":38,"column":8},"end":{"line":45,"column":9}},"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":45,"column":9}},{"start":{"line":38,"column":8},"end":{"line":45,"column":9}}],"line":38}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1,"18":1},"f":{"0":0,"1":0,"2":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/middleware/validation.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/middleware/validation.ts"],"names":[],"mappings":";;;;AAAA,yDAAiD;AACjD,qDAA2C;AAE3C,kFAA2C;AAC3C,sEAAsC;AACtC,0FAA4C;AAG5C;;;;;;;;;;;;;;;;;;;;;;;GAuBG;AACH,SAAS,UAAU,CAAI,IAAkB;IACvC,OAAO,+BAAO,CAAC,CAAO,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;QACtC,MAAM,UAAU,GAAG,gCAAY,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;QAChD,MAAM,MAAM,GAAG,MAAM,0BAAQ,CAAC,UAAU,CAAC,CAAC;QAC1C,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;YACvB,MAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;YAC1C,IAAI,CAAC,qBAAW,CAAC,2BAAU,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC,CAAC;SACpD;aAAM;YACL,GAAG,CAAC,IAAI,GAAG,UAAU,CAAC;YACtB,IAAI,EAAE,CAAC;SACR;IACH,CAAC,CAAA,CAAC,CAAC;AACL,CAAC;AAEQ,gCAAU;AACnB,kBAAe,UAAU,CAAC","sourcesContent":["import { plainToClass } from 'class-transformer';\nimport { validate } from 'class-validator';\nimport { RequestHandler } from 'express';\nimport httpStatus from 'http-status-codes';\nimport createError from 'http-errors';\nimport handler from 'express-async-handler';\nimport { ClassType } from 'class-transformer/ClassTransformer';\n\n/**\n * Validate the request body\n * Data Transfer Object: DTO\n * @param type The DTO object, defining the shape of the body\n * @throws 400 - Bad request | If at least one constraint is not respected\n *\n * @example\n * import validate from 'middlewares/validationMiddleware'\n *\n * class UserSignupDto {\n *  @IsEmail()\n *  email!: string;\n *\n *  @IsString()\n *  @IsOptional()\n *  name!: string;\n *\n *  @IsString()\n *  @MinLength(8)\n *  @MaxLength(64)\n *  password!: string;\n * }\n * router.post('/users/signup', validate(UserSignupDto), ...);\n */\nfunction validation<T>(type: ClassType<T>): RequestHandler {\n  return handler(async (req, res, next) => {\n    const parsedBody = plainToClass(type, req.body);\n    const errors = await validate(parsedBody);\n    if (errors.length !== 0) {\n      const message = errors.join('').trimEnd();\n      next(createError(httpStatus.BAD_REQUEST, message));\n    } else {\n      req.body = parsedBody;\n      next();\n    }\n  });\n}\n\nexport { validation };\nexport default validation;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"349588fdc064a388b280132125aa7eeb59fe7f02","contentHash":"511f3b124ca1abd1c237d9da80dd61bfe83831f5eab1cc9693061fc4c98a7d08"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\routes\\api\\request.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\routes\\api\\request.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":36}},"4":{"start":{"line":6,"column":25},"end":{"line":6,"column":65}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":34}},"6":{"start":{"line":8,"column":32},"end":{"line":8,"column":89}},"7":{"start":{"line":11,"column":22},"end":{"line":11,"column":40}},"8":{"start":{"line":12,"column":0},"end":{"line":12,"column":38}},"9":{"start":{"line":16,"column":0},"end":{"line":24,"column":5}},"10":{"start":{"line":19,"column":46},"end":{"line":24,"column":2}},"11":{"start":{"line":21,"column":27},"end":{"line":21,"column":82}},"12":{"start":{"line":22,"column":20},"end":{"line":22,"column":64}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":22}},"14":{"start":{"line":25,"column":0},"end":{"line":31,"column":5}},"15":{"start":{"line":27,"column":46},"end":{"line":31,"column":2}},"16":{"start":{"line":28,"column":27},"end":{"line":28,"column":82}},"17":{"start":{"line":29,"column":21},"end":{"line":29,"column":68}},"18":{"start":{"line":30,"column":4},"end":{"line":30,"column":42}},"19":{"start":{"line":32,"column":0},"end":{"line":36,"column":5}},"20":{"start":{"line":32,"column":70},"end":{"line":36,"column":2}},"21":{"start":{"line":33,"column":27},"end":{"line":33,"column":82}},"22":{"start":{"line":34,"column":18},"end":{"line":34,"column":60}},"23":{"start":{"line":35,"column":4},"end":{"line":35,"column":24}},"24":{"start":{"line":37,"column":0},"end":{"line":37,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":19,"column":32},"end":{"line":19,"column":33}},"loc":{"start":{"line":19,"column":46},"end":{"line":24,"column":2}},"line":19},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":88},"end":{"line":19,"column":89}},"loc":{"start":{"line":19,"column":101},"end":{"line":24,"column":1}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":27,"column":32},"end":{"line":27,"column":33}},"loc":{"start":{"line":27,"column":46},"end":{"line":31,"column":2}},"line":27},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":88},"end":{"line":27,"column":89}},"loc":{"start":{"line":27,"column":101},"end":{"line":31,"column":1}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":32,"column":56},"end":{"line":32,"column":57}},"loc":{"start":{"line":32,"column":70},"end":{"line":36,"column":2}},"line":32},"5":{"name":"(anonymous_5)","decl":{"start":{"line":32,"column":112},"end":{"line":32,"column":113}},"loc":{"start":{"line":32,"column":125},"end":{"line":36,"column":1}},"line":32}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1},"f":{"0":0,"1":0,"2":1,"3":1,"4":1,"5":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/routes/api/request.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/routes/api/request.ts"],"names":[],"mappings":";;;;AAAA,qCAA2C;AAC3C,kEAA+D;AAC/D,mCAAmC;AACnC,0FAA4C;AAC5C,gDAAgD;AAChD,4EAA4E;AAE5E,MAAM,aAAa,GAAG,gBAAM,EAAE,CAAC;AAuCtB,sCAAa;AAtCtB,oCAAoC;AAEpC,eAAe;AACf,kCAAkC;AAElC,aAAa,CAAC,GAAG,CACf,GAAG;AACH,yBAAyB;AACzB,2BAA2B;AAC3B,+BAAO,CAAC,CAAO,GAAQ,EAAE,GAAa,EAAE,EAAE;IACxC,yCAAyC;IACzC,MAAM,cAAc,GAAG,kBAAS,CAAC,GAAG,CAAC,+BAAc,CAAC,CAAC;IACrD,MAAM,OAAO,GAAG,MAAM,cAAc,CAAC,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IAC7D,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACpB,CAAC,CAAA,CAAC,CACH,CAAC;AAEF,aAAa,CAAC,GAAG,CACf,MAAM;AACN,yBAAyB;AACzB,+BAAO,CAAC,CAAO,GAAQ,EAAE,GAAQ,EAAE,EAAE;IACnC,MAAM,cAAc,GAAG,kBAAS,CAAC,GAAG,CAAC,+BAAc,CAAC,CAAC;IACrD,MAAM,QAAQ,GAAG,MAAM,cAAc,CAAC,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;IACjE,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;AACxC,CAAC,CAAA,CAAC,CACH,CAAC;AAEF,aAAa,CAAC,IAAI,CAChB,GAAG,EACH,+BAAO,CACL,CAAO,GAAQ,EAAE,GAAa,EAAiB,EAAE;IAC/C,MAAM,cAAc,GAAG,kBAAS,CAAC,GAAG,CAAC,+BAAc,CAAC,CAAC;IACrD,MAAM,KAAK,GAAG,MAAM,cAAc,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACzD,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;AACtB,CAAC,CAAA,CACF,CACF,CAAC;AAGF,kBAAe,aAAa,CAAC","sourcesContent":["import { Router, Response } from 'express';\r\nimport { RequestService } from '../../services/requestService';\r\nimport { Container } from 'typedi';\r\nimport handler from 'express-async-handler';\r\n//import { middleware } from '../../middleware';\r\n// import { requestSigninDto, requestSignupDto } from '../../types/request';\r\n\r\nconst requestRouter = Router();\r\n//const { validation } = middleware;\r\n\r\n// @GET '/auth'\r\n// @DEST Get request authenticated\r\n\r\nrequestRouter.get(\r\n  '/',\r\n  //middleware.requestAuth,\r\n  //middleware.checkObjectId,\r\n  handler(async (req: any, res: Response) => {\r\n    // request.req always get from middleware\r\n    const requestService = Container.get(RequestService);    \r\n    const request = await requestService.getRequests(req.params);\r\n    res.json(request);\r\n  }),\r\n);\r\n\r\nrequestRouter.get(\r\n  '/:id',\r\n  //middleware.requestAuth,\r\n  handler(async (req: any, res: any) => {\r\n    const requestService = Container.get(RequestService);\r\n    const requests = await requestService.getRequests(req.params.id);    \r\n    return res.status(200).json(requests);\r\n  }),\r\n);\r\n\r\nrequestRouter.post(\r\n  '/',  \r\n  handler(\r\n    async (req: any, res: Response): Promise<void> => {\r\n      const requestService = Container.get(RequestService);\r\n      const token = await requestService.saveRequest(req.body);\r\n      res.json({ token });\r\n    },\r\n  ),\r\n);\r\n\r\nexport { requestRouter };\r\nexport default requestRouter;\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"dd9babc798affa07f05b8999ecb64adfd19fd91f","contentHash":"11920ce8411aa947e1dbf8826dd7e385b370cdc94193a53520e3d46f75b69800"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\services\\requestService.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\services\\requestService.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":34}},"4":{"start":{"line":7,"column":28},"end":{"line":7,"column":81}},"5":{"start":{"line":8,"column":22},"end":{"line":8,"column":69}},"6":{"start":{"line":9,"column":18},"end":{"line":9,"column":36}},"7":{"start":{"line":11,"column":19},"end":{"line":11,"column":63}},"8":{"start":{"line":13,"column":21},"end":{"line":58,"column":1}},"9":{"start":{"line":16,"column":8},"end":{"line":16,"column":41}},"10":{"start":{"line":17,"column":8},"end":{"line":17,"column":29}},"11":{"start":{"line":22,"column":8},"end":{"line":30,"column":11}},"12":{"start":{"line":23,"column":12},"end":{"line":29,"column":13}},"13":{"start":{"line":24,"column":32},"end":{"line":24,"column":68}},"14":{"start":{"line":25,"column":16},"end":{"line":25,"column":31}},"15":{"start":{"line":28,"column":16},"end":{"line":28,"column":114}},"16":{"start":{"line":33,"column":8},"end":{"line":41,"column":11}},"17":{"start":{"line":34,"column":12},"end":{"line":40,"column":13}},"18":{"start":{"line":35,"column":33},"end":{"line":35,"column":69}},"19":{"start":{"line":36,"column":16},"end":{"line":36,"column":32}},"20":{"start":{"line":39,"column":16},"end":{"line":39,"column":87}},"21":{"start":{"line":45,"column":8},"end":{"line":56,"column":11}},"22":{"start":{"line":46,"column":12},"end":{"line":55,"column":13}},"23":{"start":{"line":47,"column":38},"end":{"line":47,"column":82}},"24":{"start":{"line":48,"column":16},"end":{"line":48,"column":65}},"25":{"start":{"line":49,"column":16},"end":{"line":49,"column":37}},"26":{"start":{"line":52,"column":16},"end":{"line":52,"column":35}},"27":{"start":{"line":53,"column":16},"end":{"line":53,"column":68}},"28":{"start":{"line":54,"column":16},"end":{"line":54,"column":109}},"29":{"start":{"line":59,"column":0},"end":{"line":64,"column":19}},"30":{"start":{"line":65,"column":0},"end":{"line":65,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":38},"end":{"line":19,"column":5}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":22},"end":{"line":31,"column":5}},"line":21},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":55},"end":{"line":22,"column":56}},"loc":{"start":{"line":22,"column":68},"end":{"line":30,"column":9}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":32,"column":4},"end":{"line":32,"column":5}},"loc":{"start":{"line":32,"column":24},"end":{"line":42,"column":5}},"line":32},"4":{"name":"(anonymous_4)","decl":{"start":{"line":33,"column":55},"end":{"line":33,"column":56}},"loc":{"start":{"line":33,"column":68},"end":{"line":41,"column":9}},"line":33},"5":{"name":"(anonymous_5)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":30},"end":{"line":57,"column":5}},"line":44},"6":{"name":"(anonymous_6)","decl":{"start":{"line":45,"column":55},"end":{"line":45,"column":56}},"loc":{"start":{"line":45,"column":68},"end":{"line":56,"column":9}},"line":45}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":1,"18":1,"19":1,"20":0,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":0,"29":1,"30":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":1,"5":1,"6":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/services/requestService.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/services/requestService.ts"],"names":[],"mappings":";;;;AAAA,mCAAyC;AACzC,mEAAmE;AACnE,kFAA2C;AAC3C,sEAAsC;AACtC,qCAAiC;AACjC,mDAAmD;AACnD,gEAAgC;AAChC,kBAAkB;AAElB,IAAa,cAAc,GAA3B,MAAa,cAAc;IACvB,uBAAuB;IACvB,YAEa,YAA+C,EAC9B,MAAc;QAD/B,iBAAY,GAAZ,YAAY,CAAmC;QAC9B,WAAM,GAAN,MAAM,CAAQ;QAExC,4DAA4D;IAChE,CAAC;IAED,wBAAwB;IACX,aAAa,CAAC,EAAU;;YACjC,IAAI;gBACA,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACrD,OAAO,OAAO,CAAC;aAClB;YAAC,OAAO,KAAK,EAAE;gBACZ,MAAM,qBAAW,CAAC,2BAAU,CAAC,SAAS,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC;aAC1E;QACL,CAAC;KAAA;IAEY,WAAW,CAAC,MAAW;;YAChC,IAAI;gBACA,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBACtD,OAAO,QAAQ,CAAC;aACnB;YAAC,OAAO,KAAK,EAAE;gBACZ,MAAM,qBAAW,CAAC,2BAAU,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;aAC/C;QACL,CAAC;KAAA;IACD,sBAAsB;IACT,WAAW,CAAC,YAAiB;;YACtC,IAAI;gBACA,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;gBACnE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;gBACjD,OAAO,aAAa,CAAC;aACxB;YAAC,OAAO,KAAK,EAAE;gBACZ,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBACnB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,yBAAyB,KAAK,EAAE,CAAC,CAAC;gBACpD,MAAM,qBAAW,CACb,2BAAU,CAAC,WAAW,EACtB,sBAAsB,CACzB,CAAC;aACL;QACL,CAAC;KAAA;CACJ,CAAA;AA3CY,cAAc;IAD1B,gBAAO,EAAE;IAIA,mBAAA,eAAM,CAAC,cAAc,CAAC,CAAA;IAEvB,mBAAA,eAAM,CAAC,QAAQ,CAAC,CAAA;6CADM,kBAAQ,CAAC,KAAK,EACH,gBAAM;GALnC,cAAc,CA2C1B;AA3CY,wCAAc","sourcesContent":["import  { Service, Inject} from 'typedi';\r\n// import { IUser, IUserInput, IUserService } from '../types/user';\r\nimport httpStatus from 'http-status-codes';\r\nimport createError from 'http-errors';\r\nimport { Logger } from 'winston';\r\n//import { RequestModel } from '../models/request';\r\nimport mongoose from 'mongoose';\r\n/* User service */\r\n@Service()\r\nexport class RequestService {\r\n    //private requestModel;\r\n    constructor(     \r\n         @Inject('requestModel')\r\n         private requestModel: mongoose.Model<mongoose.Document>,           \r\n        @Inject('logger') private logger: Logger        \r\n    ) {         \r\n        //this.requestModel = Container.get('requestModel');        \r\n    }\r\n\r\n    /* Get request from id*/\r\n    public async getRequestyId(id: string) {\r\n        try {\r\n            const request = await this.requestModel.findById(id);\r\n            return request;\r\n        } catch (error) {\r\n            throw createError(httpStatus.NOT_FOUND, `Request ${id} doesn't exist`);\r\n        }\r\n    }\r\n\r\n    public async getRequests(filter: any) {\r\n        try {\r\n            const requests = await this.requestModel.find(filter);\r\n            return requests;\r\n        } catch (error) {\r\n            throw createError(httpStatus.NOT_FOUND, ``);\r\n        }\r\n    }\r\n    /* Register request */\r\n    public async saveRequest(requestInput: any) {\r\n        try {\r\n            const requestRecord = await this.requestModel.create(requestInput);\r\n            this.logger.info('Request created successfully');\r\n            return requestRecord;\r\n        } catch (error) {\r\n            console.log(error);\r\n            this.logger.error(`Error create request: ${error}`);\r\n            throw createError(\r\n                httpStatus.BAD_REQUEST,\r\n                `CreateRequest: Error`,\r\n            );\r\n        }\r\n    }\r\n}\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e4d63e93798fd3009becd6efa14a933c2b3e07bc","contentHash":"fda9148690782d1e41161d66e207633b254068a15637114942ee1038a028e7f5"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\mongoose.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\mongoose.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":63}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":37}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":43}},"6":{"start":{"line":8,"column":23},"end":{"line":26,"column":2}},"7":{"start":{"line":8,"column":29},"end":{"line":26,"column":2}},"8":{"start":{"line":9,"column":15},"end":{"line":9,"column":36}},"9":{"start":{"line":10,"column":4},"end":{"line":25,"column":5}},"10":{"start":{"line":11,"column":32},"end":{"line":16,"column":10}},"11":{"start":{"line":17,"column":8},"end":{"line":17,"column":46}},"12":{"start":{"line":18,"column":8},"end":{"line":18,"column":62}},"13":{"start":{"line":19,"column":8},"end":{"line":19,"column":42}},"14":{"start":{"line":22,"column":8},"end":{"line":22,"column":55}},"15":{"start":{"line":23,"column":8},"end":{"line":23,"column":46}},"16":{"start":{"line":24,"column":8},"end":{"line":24,"column":24}},"17":{"start":{"line":27,"column":0},"end":{"line":27,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":23},"end":{"line":8,"column":24}},"loc":{"start":{"line":8,"column":29},"end":{"line":26,"column":2}},"line":8},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":71},"end":{"line":8,"column":72}},"loc":{"start":{"line":8,"column":84},"end":{"line":26,"column":1}},"line":8}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":2,"8":2,"9":2,"10":2,"11":2,"12":2,"13":2,"14":0,"15":0,"16":0,"17":1},"f":{"0":2,"1":2},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/loaders/mongoose.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/loaders/mongoose.ts"],"names":[],"mappings":";;;;AAAA,gEAAgC;AAChC,sCAAmC;AACnC,4CAA4C;AACrC,MAAM,cAAc,GAAG,GAAS,EAAE;IACvC,MAAM,EAAE,GAAG,eAAM,CAAC,KAAK,CAAC;IACxB,IAAI;QACF,MAAM,eAAe,GAAG,MAAM,kBAAQ,CAAC,OAAO,CAAC,EAAE,EAAE;YACjD,gBAAgB,EAAE,KAAK;YACvB,eAAe,EAAE,IAAI;YACrB,kBAAkB,EAAE,IAAI;YACxB,cAAc,EAAE,IAAI;SACrB,CAAC,CAAC;QACH,kBAAQ,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC5B,kBAAS,CAAC,IAAI,CAAC,4BAA4B,CAAC,CAAC;QAC7C,OAAO,eAAe,CAAC,UAAU,CAAC;KACnC;IAAC,OAAO,GAAG,EAAE;QACZ,OAAO,CAAC,GAAG,CAAC,4BAA4B,EAAE,GAAG,CAAC,CAAA;QAC9C,kBAAS,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAC7B,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;KACjB;AACH,CAAC,CAAA,CAAC;AAjBW,QAAA,cAAc,kBAiBzB","sourcesContent":["import mongoose from 'mongoose';\nimport { config } from '../config';\nimport { loggerDev } from '../utils/logger';\nexport const mongooseLoader = async () => {\n  const db = config.dbUrl;\n  try {\n    const mongoConnection = await mongoose.connect(db, {\n      useFindAndModify: false,\n      useNewUrlParser: true,\n      useUnifiedTopology: true,\n      useCreateIndex: true,\n    });\n    mongoose.set('debug', true);\n    loggerDev.info('MongoDB has been connected');\n    return mongoConnection.connection;\n  } catch (err) {\n    console.log('mongooes connection error ', err)\n    loggerDev.error(err.message);\n    process.exit(1);\n  }\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a569ad3b8399933006b4efe966c01da6541900c5","contentHash":"2f708f44c16e56d7748418ce346f179fa992c7899424a84bfc72e0e361f10059"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\models\\users.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\models\\users.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":27}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":63}},"4":{"start":{"line":7,"column":15},"end":{"line":7,"column":40}},"5":{"start":{"line":8,"column":19},"end":{"line":28,"column":24}},"6":{"start":{"line":29,"column":18},"end":{"line":29,"column":62}},"7":{"start":{"line":30,"column":0},"end":{"line":30,"column":30}},"8":{"start":{"line":31,"column":0},"end":{"line":31,"column":28}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/models/users.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/models/users.ts"],"names":[],"mappings":";;;;AAAA,gEAAgC;AAChC,+CAA+C;AAC/C,MAAM,MAAM,GAAG,kBAAQ,CAAC,MAAM,CAAC;AAE/B,MAAM,UAAU,GAAG,IAAI,MAAM,CAC3B;IACE,QAAQ,EAAE;QACR,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,CAAC,IAAI,EAAE,yBAAyB,CAAC;QAC3C,MAAM,EAAE,IAAI;KACb;IACD,KAAK,EAAE;QACL,IAAI,EAAE,MAAM;QACZ,SAAS,EAAE,IAAI;QACf,MAAM,EAAE,IAAI;QACZ,QAAQ,EAAE,CAAC,IAAI,EAAE,uBAAuB,CAAC;KAC1C;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACf;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,OAAO,EAAE,MAAM;KAChB;CACF,EACD,EAAE,UAAU,EAAE,IAAI,EAAE,CACrB,CAAC;AAEF,MAAM,SAAS,GAAG,kBAAQ,CAAC,KAAK,CAAoB,MAAM,EAAE,UAAU,CAAC,CAAC;AAE/D,8BAAS;AAClB,kBAAe,SAAS,CAAC","sourcesContent":["import mongoose from 'mongoose';\n//import { IUser } from '../../src/types/user';\nconst Schema = mongoose.Schema;\n\nconst UserSchema = new Schema(\n  {\n    username: {\n      type: String,\n      required: [true, 'Please enter a username'],\n      unique: true,\n    },\n    email: {\n      type: String,\n      lowercase: true,\n      unique: true,\n      required: [true, 'Please enter an email'],\n    },\n    password: {\n      type: String,\n      required: true,\n    },\n    role: {\n      type: String,\n      default: 'user',\n    },\n  },\n  { timestamps: true },\n);\n\nconst UserModel = mongoose.model<mongoose.Document>('user', UserSchema);\n\nexport { UserModel };\nexport default UserModel;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e6c09c5322bd68df650687ad73bfdecc149b06c0","contentHash":"de23ef96fd2de8a76454a19c3ec06c57502a83cd09108fc61ae6a407bd92f1a5"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\models\\request.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\models\\request.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":30}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":63}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":40}},"5":{"start":{"line":7,"column":22},"end":{"line":45,"column":2}},"6":{"start":{"line":46,"column":21},"end":{"line":46,"column":71}},"7":{"start":{"line":47,"column":0},"end":{"line":47,"column":36}},"8":{"start":{"line":48,"column":0},"end":{"line":48,"column":31}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/models/request.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/models/request.ts"],"names":[],"mappings":";;;;AAAA,gEAAgC;AAChC,MAAM,MAAM,GAAG,kBAAQ,CAAC,MAAM,CAAC;AAE/B,MAAM,aAAa,GAAG,IAAI,MAAM,CAAC;IAC7B,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,WAAW,EAAE;QACT,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,WAAW,EAAE;QACT,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAClB;IACD,SAAS,EAAE;QACP,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAClB;IACD,UAAU,EAAE;QACR,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAClB;IACD,SAAS,EAAE;QACP,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,IAAI;KACjB;IACD,QAAQ,EAAE;QACN,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,KAAK;KAClB;IACD,SAAS,EAAG;QACR,IAAI,EAAE,IAAI;QACV,QAAQ,EAAE,IAAI;QACd,OAAO,EAAG,IAAI,CAAC,GAAG,EAAE;KACvB;IACD,SAAS,EAAE;QACP,IAAI,EAAE,IAAI;QACV,QAAQ,EAAE,KAAK;KAClB;CAEJ,CAAC,CAAC;AAEH,MAAM,YAAY,GAAG,kBAAQ,CAAC,KAAK,CAAoB,SAAS,EAAE,aAAa,CAAC,CAAC;AAExE,oCAAY;AACrB,kBAAe,YAAY,CAAC","sourcesContent":["import mongoose from 'mongoose';\r\nconst Schema = mongoose.Schema;\r\n\r\nconst RequestSchema = new Schema({\r\n    category: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    subCategory: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    description: {\r\n        type: String,\r\n        required: false\r\n    },\r\n    requestor: {\r\n        type: Object,\r\n        required: false\r\n    },\r\n    assignedTo: {\r\n        type: Object,\r\n        required: false\r\n    },    \r\n    reqStatus: {\r\n        type: String,\r\n        required: true\r\n    },\r\n    comments: {\r\n        type: Object,\r\n        required: false\r\n    },\r\n    createdAt : {\r\n        type: Date,\r\n        required: true,        \r\n        default : Date.now()\r\n    },\r\n    updatedAt: {\r\n        type: Date,\r\n        required: false\r\n    },\r\n    \r\n});\r\n\r\nconst RequestModel = mongoose.model<mongoose.Document>('request', RequestSchema);\r\n\r\nexport { RequestModel };\r\nexport default RequestModel;\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0685c74c0a5cbd37cc09909fe8e93e5950316d8f","contentHash":"316f366d82aed8ed048f77bb8377c0d4c117065e8bab7fc21ae811591ba1df61"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\dependencyInjector.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\dependencyInjector.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":32}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":34}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":43}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},"6":{"start":{"line":8,"column":15},"end":{"line":8,"column":65}},"7":{"start":{"line":9,"column":27},"end":{"line":23,"column":2}},"8":{"start":{"line":9,"column":44},"end":{"line":23,"column":2}},"9":{"start":{"line":10,"column":4},"end":{"line":22,"column":5}},"10":{"start":{"line":11,"column":8},"end":{"line":14,"column":11}},"11":{"start":{"line":12,"column":12},"end":{"line":12,"column":55}},"12":{"start":{"line":13,"column":12},"end":{"line":13,"column":52}},"13":{"start":{"line":15,"column":8},"end":{"line":15,"column":64}},"14":{"start":{"line":16,"column":8},"end":{"line":16,"column":61}},"15":{"start":{"line":17,"column":8},"end":{"line":17,"column":62}},"16":{"start":{"line":20,"column":8},"end":{"line":20,"column":82}},"17":{"start":{"line":21,"column":8},"end":{"line":21,"column":20}},"18":{"start":{"line":24,"column":0},"end":{"line":24,"column":48}},"19":{"start":{"line":25,"column":0},"end":{"line":25,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":27},"end":{"line":9,"column":28}},"loc":{"start":{"line":9,"column":44},"end":{"line":23,"column":2}},"line":9},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":86},"end":{"line":9,"column":87}},"loc":{"start":{"line":9,"column":99},"end":{"line":23,"column":1}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":23},"end":{"line":11,"column":24}},"loc":{"start":{"line":11,"column":28},"end":{"line":14,"column":9}},"line":11}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":2,"10":2,"11":4,"12":4,"13":2,"14":2,"15":2,"16":0,"17":0,"18":1,"19":1},"f":{"0":2,"1":2,"2":4},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/loaders/dependencyInjector.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/loaders/dependencyInjector.ts"],"names":[],"mappings":";;;;AAAA,mCAAmC;AACnC,4CAA4C;AAC5C,sCAAmC;AACnC,kEAAoC;AAGpC,MAAM,kBAAkB,GAAG,CAAO,EAChC,MAAM,GAGP,EAAiB,EAAE;IAClB,IAAI;QACF,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YACjB,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;YAC3C,kBAAS,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,cAAM,CAAC,SAAS,CAAC,eAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QACvC,kBAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,kBAAS,CAAC,CAAC;QACnC,kBAAS,CAAC,GAAG,CAAC,aAAa,EAAE,cAAM,CAAC,CAAC;KACtC;IAAC,OAAO,KAAK,EAAE;QACd,kBAAS,CAAC,KAAK,CAAC,wCAAwC,KAAK,EAAE,CAAC,CAAC;QACjE,MAAM,KAAK,CAAC;KACb;AACH,CAAC,CAAA,CAAC;AAEO,gDAAkB;AAC3B,kBAAe,kBAAkB,CAAC","sourcesContent":["import { Container } from 'typedi';\nimport { loggerDev } from '../utils/logger';\nimport { config } from '../config';\nimport sgMail from '@sendgrid/mail';\nimport { IModelDI } from '../types/dependencyInjectors';\n\nconst dependencyInjector = async ({\n  models,\n}: {\n  models: IModelDI[];\n}): Promise<void> => {\n  try {\n    models.forEach(m => {\n      console.log('initialize model...', m.name);\n      Container.set(m.name, m.model);\n    });\n\n    sgMail.setApiKey(config.emails.apiKey);\n    Container.set('logger', loggerDev);\n    Container.set('emailClient', sgMail);\n  } catch (error) {\n    loggerDev.error(`Error on dependency injector loader: ${error}`);\n    throw error;\n  }\n};\n\nexport { dependencyInjector };\nexport default dependencyInjector;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"41e1a176b6a48d842ca7fc102932973d0b746fc9","contentHash":"8e41cf97fbfee82047cca5e9301a99b639008cfef5cda6a044cada6ce3381fc3"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\events.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\loaders\\events.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":31}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/loaders/events.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/loaders/events.ts"],"names":[],"mappings":";;AAAA,+BAA6B","sourcesContent":["import '../subscribers/user';\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8e0d0fb95a987732baf497a29afb82521bda1313","contentHash":"42b977f04b4be6e560c0844bbfdc0c0b996a9341610322da3a173177b4a41e60"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\subscribers\\user.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\subscribers\\user.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":17},"end":{"line":4,"column":34}},"3":{"start":{"line":5,"column":25},"end":{"line":5,"column":50}},"4":{"start":{"line":6,"column":16},"end":{"line":6,"column":34}},"5":{"start":{"line":7,"column":21},"end":{"line":54,"column":1}},"6":{"start":{"line":19,"column":8},"end":{"line":31,"column":11}},"7":{"start":{"line":20,"column":27},"end":{"line":20,"column":59}},"8":{"start":{"line":21,"column":12},"end":{"line":30,"column":13}},"9":{"start":{"line":22,"column":34},"end":{"line":22,"column":69}},"10":{"start":{"line":23,"column":16},"end":{"line":23,"column":78}},"11":{"start":{"line":24,"column":16},"end":{"line":24,"column":77}},"12":{"start":{"line":27,"column":16},"end":{"line":27,"column":90}},"13":{"start":{"line":29,"column":16},"end":{"line":29,"column":24}},"14":{"start":{"line":34,"column":8},"end":{"line":52,"column":11}},"15":{"start":{"line":35,"column":27},"end":{"line":35,"column":59}},"16":{"start":{"line":36,"column":12},"end":{"line":51,"column":13}},"17":{"start":{"line":45,"column":16},"end":{"line":45,"column":92}},"18":{"start":{"line":48,"column":16},"end":{"line":48,"column":90}},"19":{"start":{"line":50,"column":16},"end":{"line":50,"column":24}},"20":{"start":{"line":55,"column":0},"end":{"line":60,"column":51}},"21":{"start":{"line":61,"column":0},"end":{"line":66,"column":51}},"22":{"start":{"line":67,"column":0},"end":{"line":69,"column":19}},"23":{"start":{"line":70,"column":0},"end":{"line":70,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":35},"end":{"line":32,"column":5}},"line":18},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":55},"end":{"line":19,"column":56}},"loc":{"start":{"line":19,"column":68},"end":{"line":31,"column":9}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":33,"column":4},"end":{"line":33,"column":5}},"loc":{"start":{"line":33,"column":38},"end":{"line":53,"column":5}},"line":33},"3":{"name":"(anonymous_3)","decl":{"start":{"line":34,"column":55},"end":{"line":34,"column":56}},"loc":{"start":{"line":34,"column":68},"end":{"line":52,"column":9}},"line":34}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1,"22":1,"23":1},"f":{"0":0,"1":0,"2":0,"3":0},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/subscribers/user.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/subscribers/user.ts"],"names":[],"mappings":";;;AAAA,mCAAmC;AACnC,mDAAqD;AAGrD,mCAAoC;AAIpC,IAAqB,cAAc,GAAnC,MAAqB,cAAc;IACjC;;;;;;;;;OASG;IAEU,YAAY,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAkB;;YACxD,MAAM,MAAM,GAAW,kBAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAE/C,IAAI;gBACF,MAAM,SAAS,GAAG,kBAAS,CAAC,GAAG,CAAC,WAAW,CAE1C,CAAC;gBAEF,SAAS,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,SAAS,EAAE,IAAI,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC;gBAC9D,MAAM,CAAC,IAAI,CAAC,iBAAiB,QAAQ,sBAAsB,CAAC,CAAC;aAC9D;YAAC,OAAO,CAAC,EAAE;gBACV,MAAM,CAAC,KAAK,CAAC,qBAAqB,iBAAS,CAAC,IAAI,CAAC,MAAM,MAAM,EAAE,CAAC,CAAC,CAAC;gBAElE,wDAAwD;gBACxD,MAAM,CAAC,CAAC;aACT;QACH,CAAC;KAAA;IAGY,YAAY,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAkB;;YAC3D,MAAM,MAAM,GAAW,kBAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAE/C,IAAI;gBACF;;mBAEG;gBACH,0EAA0E;gBAC1E,wCAAwC;gBACxC,sDAAsD;gBACtD,wCAAwC;gBACxC,6DAA6D;gBAC7D,MAAM,CAAC,IAAI,CACT,yCAAyC,QAAQ,MAAM,KAAK,EAAE,CAC/D,CAAC;aACH;YAAC,OAAO,CAAC,EAAE;gBACV,MAAM,CAAC,KAAK,CAAC,qBAAqB,iBAAS,CAAC,IAAI,CAAC,MAAM,MAAM,EAAE,CAAC,CAAC,CAAC;gBAElE,yDAAyD;gBACzD,MAAM,CAAC,CAAC;aACT;QACH,CAAC;KAAA;CACF,CAAA;AAzCC;IADC,mBAAE,CAAC,iBAAS,CAAC,IAAI,CAAC,MAAM,CAAC;;;;kDAiBzB;AAGD;IADC,mBAAE,CAAC,iBAAS,CAAC,IAAI,CAAC,MAAM,CAAC;;;;kDAsBzB;AApDkB,cAAc;IADlC,gCAAe,EAAE;GACG,cAAc,CAqDlC;kBArDoB,cAAc","sourcesContent":["import { Container } from 'typedi';\nimport { EventSubscriber, On } from 'event-dispatch';\nimport mongoose from 'mongoose';\nimport { Logger } from 'winston';\nimport { AppEvents } from './event';\nimport { IUser } from 'src/types/user';\n\n@EventSubscriber()\nexport default class UserSubscriber {\n  /**\n   * A example\n   * save the last time a user signin, your boss will be pleased.\n   *\n   * Altough it works in this tiny toy API, please don't do this for a production product\n   * just spamming insert/update to mongo will kill it eventualy\n   *\n   * Use another approach like emit events to a queue (rabbitmq/aws sqs),\n   * then save the latest in Redis/Memcache or something similar\n   */\n  @On(AppEvents.user.signIn)\n  public async onUserSignIn({ id, username }: Partial<IUser>) {\n    const Logger: Logger = Container.get('logger');\n\n    try {\n      const UserModel = Container.get('userModel') as mongoose.Model<\n        IUser & mongoose.Document\n      >;\n\n      UserModel.update({ id }, { $set: { lastLogin: new Date() } });\n      Logger.info(`======> User '${username}' has been connected`);\n    } catch (e) {\n      Logger.error(`🔥 Error on event ${AppEvents.user.signIn}: %o`, e);\n\n      // Throw the error so the process die (check src/app.ts)\n      throw e;\n    }\n  }\n\n  @On(AppEvents.user.signUp)\n  public async onUserSignUp({ username, email }: Partial<IUser>) {\n    const Logger: Logger = Container.get('logger');\n\n    try {\n      /**\n       * @TODO implement this\n       */\n      // Call the tracker tool so your investor knows that there is a new signup\n      // and leave you alone for another hour.\n      // TrackerService.track('user.signup', { email, _id })\n      // Start your email sequence or whatever\n      // MailService.startSequence('user.welcome', { email, name })\n      Logger.info(\n        `======> New user has been registered: ${username} - ${email}`,\n      );\n    } catch (e) {\n      Logger.error(`🔥 Error on event ${AppEvents.user.signUp}: %o`, e);\n\n      // Throw the error so the process dies (check src/app.ts)\n      throw e;\n    }\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1c58abc04f8e9793fc8b7257ce9eea374cabc6e1","contentHash":"9666c903c60da5ce4afe515e313ba1890efb886b4a51b906185e3ca83e017525"},"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\test\\user.spec.ts":{"path":"C:\\Rajeshri\\learning\\nodejs\\sample\\src\\test\\user.spec.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":30}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":37}},"4":{"start":{"line":6,"column":16},"end":{"line":6,"column":42}},"5":{"start":{"line":9,"column":17},"end":{"line":9,"column":37}},"6":{"start":{"line":10,"column":16},"end":{"line":10,"column":32}},"7":{"start":{"line":11,"column":17},"end":{"line":11,"column":34}},"8":{"start":{"line":12,"column":16},"end":{"line":12,"column":57}},"9":{"start":{"line":14,"column":13},"end":{"line":14,"column":28}},"10":{"start":{"line":15,"column":14},"end":{"line":15,"column":30}},"11":{"start":{"line":16,"column":23},"end":{"line":16,"column":71}},"12":{"start":{"line":17,"column":23},"end":{"line":17,"column":50}},"13":{"start":{"line":18,"column":15},"end":{"line":18,"column":26}},"14":{"start":{"line":19,"column":0},"end":{"line":19,"column":25}},"15":{"start":{"line":20,"column":13},"end":{"line":26,"column":1}},"16":{"start":{"line":27,"column":14},"end":{"line":27,"column":105}},"17":{"start":{"line":28,"column":0},"end":{"line":75,"column":3}},"18":{"start":{"line":30,"column":4},"end":{"line":40,"column":8}},"19":{"start":{"line":30,"column":25},"end":{"line":40,"column":6}},"20":{"start":{"line":31,"column":8},"end":{"line":31,"column":39}},"21":{"start":{"line":32,"column":8},"end":{"line":32,"column":29}},"22":{"start":{"line":33,"column":25},"end":{"line":33,"column":66}},"23":{"start":{"line":34,"column":8},"end":{"line":34,"column":31}},"24":{"start":{"line":35,"column":24},"end":{"line":35,"column":64}},"25":{"start":{"line":36,"column":8},"end":{"line":36,"column":30}},"26":{"start":{"line":37,"column":23},"end":{"line":37,"column":62}},"27":{"start":{"line":38,"column":8},"end":{"line":38,"column":29}},"28":{"start":{"line":39,"column":8},"end":{"line":39,"column":63}},"29":{"start":{"line":41,"column":4},"end":{"line":43,"column":8}},"30":{"start":{"line":41,"column":24},"end":{"line":43,"column":6}},"31":{"start":{"line":42,"column":8},"end":{"line":42,"column":28}},"32":{"start":{"line":44,"column":4},"end":{"line":51,"column":8}},"33":{"start":{"line":44,"column":71},"end":{"line":51,"column":6}},"34":{"start":{"line":45,"column":23},"end":{"line":45,"column":48}},"35":{"start":{"line":46,"column":8},"end":{"line":50,"column":11}},"36":{"start":{"line":48,"column":12},"end":{"line":48,"column":44}},"37":{"start":{"line":49,"column":12},"end":{"line":49,"column":70}},"38":{"start":{"line":52,"column":4},"end":{"line":59,"column":8}},"39":{"start":{"line":52,"column":97},"end":{"line":59,"column":6}},"40":{"start":{"line":53,"column":23},"end":{"line":53,"column":48}},"41":{"start":{"line":54,"column":8},"end":{"line":58,"column":11}},"42":{"start":{"line":56,"column":12},"end":{"line":56,"column":44}},"43":{"start":{"line":57,"column":12},"end":{"line":57,"column":75}},"44":{"start":{"line":60,"column":4},"end":{"line":66,"column":8}},"45":{"start":{"line":60,"column":72},"end":{"line":66,"column":6}},"46":{"start":{"line":61,"column":23},"end":{"line":61,"column":48}},"47":{"start":{"line":62,"column":8},"end":{"line":65,"column":11}},"48":{"start":{"line":64,"column":12},"end":{"line":64,"column":49}},"49":{"start":{"line":67,"column":4},"end":{"line":74,"column":8}},"50":{"start":{"line":67,"column":83},"end":{"line":74,"column":6}},"51":{"start":{"line":68,"column":23},"end":{"line":68,"column":48}},"52":{"start":{"line":69,"column":8},"end":{"line":73,"column":11}},"53":{"start":{"line":71,"column":12},"end":{"line":71,"column":41}},"54":{"start":{"line":72,"column":12},"end":{"line":72,"column":68}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":28,"column":26},"end":{"line":28,"column":27}},"loc":{"start":{"line":28,"column":32},"end":{"line":75,"column":1}},"line":28},"1":{"name":"(anonymous_1)","decl":{"start":{"line":30,"column":19},"end":{"line":30,"column":20}},"loc":{"start":{"line":30,"column":25},"end":{"line":40,"column":6}},"line":30},"2":{"name":"(anonymous_2)","decl":{"start":{"line":30,"column":67},"end":{"line":30,"column":68}},"loc":{"start":{"line":30,"column":80},"end":{"line":40,"column":5}},"line":30},"3":{"name":"(anonymous_3)","decl":{"start":{"line":41,"column":18},"end":{"line":41,"column":19}},"loc":{"start":{"line":41,"column":24},"end":{"line":43,"column":6}},"line":41},"4":{"name":"(anonymous_4)","decl":{"start":{"line":41,"column":66},"end":{"line":41,"column":67}},"loc":{"start":{"line":41,"column":79},"end":{"line":43,"column":5}},"line":41},"5":{"name":"(anonymous_5)","decl":{"start":{"line":44,"column":65},"end":{"line":44,"column":66}},"loc":{"start":{"line":44,"column":71},"end":{"line":51,"column":6}},"line":44},"6":{"name":"(anonymous_6)","decl":{"start":{"line":44,"column":113},"end":{"line":44,"column":114}},"loc":{"start":{"line":44,"column":126},"end":{"line":51,"column":5}},"line":44},"7":{"name":"(anonymous_7)","decl":{"start":{"line":47,"column":18},"end":{"line":47,"column":19}},"loc":{"start":{"line":47,"column":30},"end":{"line":50,"column":9}},"line":47},"8":{"name":"(anonymous_8)","decl":{"start":{"line":52,"column":91},"end":{"line":52,"column":92}},"loc":{"start":{"line":52,"column":97},"end":{"line":59,"column":6}},"line":52},"9":{"name":"(anonymous_9)","decl":{"start":{"line":52,"column":139},"end":{"line":52,"column":140}},"loc":{"start":{"line":52,"column":152},"end":{"line":59,"column":5}},"line":52},"10":{"name":"(anonymous_10)","decl":{"start":{"line":55,"column":18},"end":{"line":55,"column":19}},"loc":{"start":{"line":55,"column":30},"end":{"line":58,"column":9}},"line":55},"11":{"name":"(anonymous_11)","decl":{"start":{"line":60,"column":66},"end":{"line":60,"column":67}},"loc":{"start":{"line":60,"column":72},"end":{"line":66,"column":6}},"line":60},"12":{"name":"(anonymous_12)","decl":{"start":{"line":60,"column":114},"end":{"line":60,"column":115}},"loc":{"start":{"line":60,"column":127},"end":{"line":66,"column":5}},"line":60},"13":{"name":"(anonymous_13)","decl":{"start":{"line":63,"column":18},"end":{"line":63,"column":19}},"loc":{"start":{"line":63,"column":30},"end":{"line":65,"column":9}},"line":63},"14":{"name":"(anonymous_14)","decl":{"start":{"line":67,"column":77},"end":{"line":67,"column":78}},"loc":{"start":{"line":67,"column":83},"end":{"line":74,"column":6}},"line":67},"15":{"name":"(anonymous_15)","decl":{"start":{"line":67,"column":125},"end":{"line":67,"column":126}},"loc":{"start":{"line":67,"column":138},"end":{"line":74,"column":5}},"line":67},"16":{"name":"(anonymous_16)","decl":{"start":{"line":70,"column":18},"end":{"line":70,"column":19}},"loc":{"start":{"line":70,"column":27},"end":{"line":73,"column":9}},"line":70}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1},"b":{},"inputSourceMap":{"version":3,"file":"C:/Rajeshri/learning/nodejs/sample/src/test/user.spec.ts","sources":["C:/Rajeshri/learning/nodejs/sample/src/test/user.spec.ts"],"names":[],"mappings":"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","sourcesContent":["\r\nprocess.env.NODE_ENV = 'test';\r\nimport { Server } from '../server';\r\nimport { UserModel } from '../models/users';\r\n//import { IUser} from '../types/user';\r\n//import mongoose from 'mongoose';\r\nimport { config } from '../config';\r\nimport { describe, it, before, after } from 'mocha';\r\nimport { Container } from 'typedi';\r\nimport axios from 'axios';\r\n//Require the dev-dependencies\r\nconst chai = require('chai');\r\nconst sinon = require('sinon');\r\nimport jwt from 'jsonwebtoken';\r\nconst chaiaspromised = require('chai-as-promised');\r\nconst expect = chai.expect;\r\n\r\nchai.use(chaiaspromised);\r\nconst user = {\r\n  id: 1,\r\n  username: 'Raj',\r\n  email: 'Raj@gmail.com',\r\n  password: '$2b$10$P0SH1FnHFiOL5mITqVFwpOOMfD9U2AgOF5sWpeOBDpBPbnVtj2qe.',\r\n  role: 'Admin'\r\n}\r\n\r\nconst token = jwt.sign({ user: user }, config.jwtSecret, { expiresIn: '1h' });\r\n\r\n\r\ndescribe('/User', () => {\r\n\r\n  let server;\r\n  before(async () => {\r\n    server = new Server();\r\n    server.startServer();\r\n    const findById = sinon.stub(UserModel, 'findById')\r\n    findById.returns(user);\r\n    const findOne = sinon.stub(UserModel, 'findOne')\r\n    findOne.returns(user);    \r\n    const create = sinon.stub(UserModel, 'create')\r\n    create.returns(user);        \r\n    Container.set('userModel', UserModel);\r\n  });\r\n\r\n  after(async () => {\r\n    server.stopServer();\r\n  })\r\n\r\n  it('it should be fulfilled and return user details', async () => {\r\n    const header = { 'x-auth-token': token };\r\n    return expect(axios.get('http://localhost:5000/api/user',\r\n      { headers: header })).to.be.fulfilled\r\n      .then(response => {\r\n        expect(response).not.to.be.null\r\n        expect(response.data.username).to.be.equal(user.username)\r\n      })\r\n  });\r\n\r\n\r\n  it('it should be fulfilled and return current logged in user, based on token', async () => {\r\n    const header = { 'x-auth-token': token };\r\n    return expect(axios.get('http://localhost:5000/api/user/me',\r\n      { headers: header })).to.be.fulfilled\r\n      .then(response => {\r\n        expect(response).not.to.be.null        \r\n        expect(response.data.user.username).to.be.equal(user.username)\r\n      })\r\n  });\r\n\r\n  it('it should be authenticate user and return token', async () => {\r\n    const header = { 'x-auth-token': token };\r\n    return expect(axios.post('http://localhost:5000/api/user/login', { username : 'Raj', email: 'raj@gmail.com', password: '1234' },\r\n      { headers: header })).to.be.fulfilled\r\n      .then(response => {        \r\n        expect(response.data).not.to.be.null\r\n      })\r\n  });\r\n\r\n  it('it should be rejected, when exxisting user try to register', async () => {\r\n    const header = { 'x-auth-token': token };\r\n    return expect(axios.post('http://localhost:5000/api/user', { username : 'Raj', email: 'raj@gmail.com', password: '1234' },\r\n      { headers: header })).to.be.rejected\r\n      .then(error => {        \r\n        expect(error).not.to.be.null\r\n        expect(error.response.data.error.statusCode).equal(409)\r\n      })\r\n  });\r\n});\r\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"53e5cc8c93980ad3fdf7345548c9b5fecc2ff3c6","contentHash":"6df4ebde7097f686343117e4b90315b65ec7566a16deb3e270e16cd3bb2c0b38"}}